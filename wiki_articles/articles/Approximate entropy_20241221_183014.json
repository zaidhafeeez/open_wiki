{
  "title": "Approximate entropy",
  "summary": "In statistics, an approximate entropy (ApEn) is a technique used to quantify the amount of regularity and the unpredictability of fluctuations over time-series data. For example, consider two series of data:\n\nSeries A: (0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, ...), which alternates 0 and 1.\nSeries B: (0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, ...), which has either a value of 0 or 1, chosen randomly, each with probability 1/2.\nMoment statistics, such as mean and variance, will not ",
  "content": "---\ntitle: Approximate entropy\nurl: https://en.wikipedia.org/wiki/Approximate_entropy\nlanguage: en\ncategories: [\"Category:Articles with example Python (programming language) code\", \"Category:Articles with short description\", \"Category:Entropy and information\", \"Category:Short description matches Wikidata\", \"Category:Time series\"]\nreferences: 0\nlast_modified: 2024-12-19T14:30:27Z\n---\n\n# Approximate entropy\n\n## Summary\n\nIn statistics, an approximate entropy (ApEn) is a technique used to quantify the amount of regularity and the unpredictability of fluctuations over time-series data. For example, consider two series of data:\n\nSeries A: (0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, ...), which alternates 0 and 1.\nSeries B: (0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, ...), which has either a value of 0 or 1, chosen randomly, each with probability 1/2.\nMoment statistics, such as mean and variance, will not \n\n## Full Content\n\nIn statistics, an approximate entropy (ApEn) is a technique used to quantify the amount of regularity and the unpredictability of fluctuations over time-series data. For example, consider two series of data:\n\nSeries A: (0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, ...), which alternates 0 and 1.\nSeries B: (0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, ...), which has either a value of 0 or 1, chosen randomly, each with probability 1/2.\nMoment statistics, such as mean and variance, will not distinguish between these two series. Nor will rank order statistics distinguish between these series. Yet series A is perfectly regular: knowing a term has the value of 1 enables one to predict with certainty that the next term will have the value of 0. In contrast, series B is randomly valued: knowing a term has the value of 1 gives no insight into what value the next term will have.\nRegularity was originally measured by exact regularity statistics, which has mainly centered on various entropy measures.\nHowever, accurate entropy calculation requires vast amounts of data, and the results will be greatly influenced by system noise, therefore it is not practical to apply these methods to experimental data. ApEn was first proposed (under a different name) by A. Cohen and I. Procaccia,\nas an approximate algorithm to compute an exact regularity statistic, Kolmogorov–Sinai entropy, and later popularized by Steve M. Pincus. ApEn was initially used to analyze chaotic dynamics and medical data, such as heart rate, and later spread its applications in finance, physiology, human factors engineering, and climate sciences.\n\nAlgorithm\nA comprehensive step-by-step tutorial with an explanation of the theoretical foundations of Approximate Entropy is available. The algorithm is:\n\nStep 1\nAssume a time series of data \n  \n    \n      \n        u\n        (\n        1\n        )\n        ,\n        u\n        (\n        2\n        )\n        ,\n        …\n        ,\n        u\n        (\n        N\n        )\n      \n    \n    {\\displaystyle u(1),u(2),\\ldots ,u(N)}\n  \n. These are \n  \n    \n      \n        N\n      \n    \n    {\\displaystyle N}\n  \n raw data values from measurements equally spaced in time.\nStep 2\nLet \n  \n    \n      \n        m\n        ∈\n        \n          \n            Z\n          \n          \n            +\n          \n        \n      \n    \n    {\\displaystyle m\\in \\mathbb {Z} ^{+}}\n  \n be a positive integer, with \n  \n    \n      \n        m\n        ≤\n        N\n      \n    \n    {\\displaystyle m\\leq N}\n  \n, which represents the length of a run of data (essentially a window).Let \n  \n    \n      \n        r\n        ∈\n        \n          \n            R\n          \n          \n            +\n          \n        \n      \n    \n    {\\displaystyle r\\in \\mathbb {R} ^{+}}\n  \n be a positive real number, which specifies a filtering level.Let \n  \n    \n      \n        n\n        =\n        N\n        −\n        m\n        +\n        1\n      \n    \n    {\\displaystyle n=N-m+1}\n  \n.\nStep 3\nDefine \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n        =\n        \n          \n            [\n          \n        \n        u\n        (\n        i\n        )\n        ,\n        u\n        (\n        i\n        +\n        1\n        )\n        ,\n        …\n        ,\n        u\n        (\n        i\n        +\n        m\n        −\n        1\n        )\n        \n          \n            ]\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {x} (i)={\\big [}u(i),u(i+1),\\ldots ,u(i+m-1){\\big ]}}\n  \n for each \n  \n    \n      \n        i\n      \n    \n    {\\displaystyle i}\n  \n where \n  \n    \n      \n        1\n        ≤\n        i\n        ≤\n        n\n      \n    \n    {\\displaystyle 1\\leq i\\leq n}\n  \n. In other words, \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (i)}\n  \n is an \n  \n    \n      \n        m\n      \n    \n    {\\displaystyle m}\n  \n-dimensional vector that contains the run of data starting with \n  \n    \n      \n        u\n        (\n        i\n        )\n      \n    \n    {\\displaystyle u(i)}\n  \n.Define the distance between two vectors \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (i)}\n  \n and \n  \n    \n      \n        \n          x\n        \n        (\n        j\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (j)}\n  \n as the maximum of the distances between their respective components, given by\n\n  \n    \n      \n        \n          \n            \n              \n                d\n                [\n                \n                  x\n                \n                (\n                i\n                )\n                ,\n                \n                  x\n                \n                (\n                j\n                )\n                ]\n              \n              \n                \n                =\n                \n                  max\n                  \n                    k\n                  \n                \n                \n                  \n                    (\n                  \n                \n                \n                  |\n                \n                \n                  x\n                \n                (\n                i\n                \n                  )\n                  \n                    k\n                  \n                \n                −\n                \n                  x\n                \n                (\n                j\n                \n                  )\n                  \n                    k\n                  \n                \n                \n                  |\n                \n                \n                  \n                    )\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  max\n                  \n                    k\n                  \n                \n                \n                  \n                    (\n                  \n                \n                \n                  |\n                \n                u\n                (\n                i\n                +\n                k\n                −\n                1\n                )\n                −\n                u\n                (\n                j\n                +\n                k\n                −\n                1\n                )\n                \n                  |\n                \n                \n                  \n                    )\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}d[\\mathbf {x} (i),\\mathbf {x} (j)]&=\\max _{k}{\\big (}|\\mathbf {x} (i)_{k}-\\mathbf {x} (j)_{k}|{\\big )}\\\\&=\\max _{k}{\\big (}|u(i+k-1)-u(j+k-1)|{\\big )}\\\\\\end{aligned}}}\n  \n\nfor \n  \n    \n      \n        1\n        ≤\n        k\n        ≤\n        m\n      \n    \n    {\\displaystyle 1\\leq k\\leq m}\n  \n.\nStep 4\nDefine a count \n  \n    \n      \n        \n          C\n          \n            i\n          \n          \n            m\n          \n        \n      \n    \n    {\\displaystyle C_{i}^{m}}\n  \n as\n\n  \n    \n      \n        \n          C\n          \n            i\n          \n          \n            m\n          \n        \n        (\n        r\n        )\n        =\n        \n          \n            \n              (\n              \n                number of \n              \n              j\n              \n                 such that \n              \n              d\n              [\n              \n                x\n              \n              (\n              i\n              )\n              ,\n              \n                x\n              \n              (\n              j\n              )\n              ]\n              ≤\n              r\n              )\n            \n            n\n          \n        \n      \n    \n    {\\displaystyle C_{i}^{m}(r)={({\\text{number of }}j{\\text{ such that }}d[\\mathbf {x} (i),\\mathbf {x} (j)]\\leq r) \\over n}}\n  \n\nfor each \n  \n    \n      \n        i\n      \n    \n    {\\displaystyle i}\n  \n where \n  \n    \n      \n        1\n        ≤\n        i\n        ,\n        j\n        ≤\n        n\n      \n    \n    {\\displaystyle 1\\leq i,j\\leq n}\n  \n. Note that since \n  \n    \n      \n        j\n      \n    \n    {\\displaystyle j}\n  \n takes on all values between 1 and \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n, the match will be counted when \n  \n    \n      \n        j\n        =\n        i\n      \n    \n    {\\displaystyle j=i}\n  \n (i.e. when the test subsequence, \n  \n    \n      \n        \n          x\n        \n        (\n        j\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (j)}\n  \n, is matched against itself, \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (i)}\n  \n).\nStep 5\nDefine\n\n  \n    \n      \n        \n          ϕ\n          \n            m\n          \n        \n        (\n        r\n        )\n        =\n        \n          \n            1\n            n\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        log\n        ⁡\n        (\n        \n          C\n          \n            i\n          \n          \n            m\n          \n        \n        (\n        r\n        )\n        )\n      \n    \n    {\\displaystyle \\phi ^{m}(r)={1 \\over n}\\sum _{i=1}^{n}\\log(C_{i}^{m}(r))}\n  \n\nwhere \n  \n    \n      \n        log\n      \n    \n    {\\displaystyle \\log }\n  \n is the natural logarithm, and for a fixed \n  \n    \n      \n        m\n      \n    \n    {\\displaystyle m}\n  \n, \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n, and \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n as set in Step 2.\nStep 6\nDefine approximate entropy (\n  \n    \n      \n        \n          A\n          p\n          E\n          n\n        \n      \n    \n    {\\displaystyle \\mathrm {ApEn} }\n  \n) as\n\n  \n    \n      \n        \n          A\n          p\n          E\n          n\n        \n        (\n        m\n        ,\n        r\n        ,\n        N\n        )\n        (\n        u\n        )\n        =\n        \n          ϕ\n          \n            m\n          \n        \n        (\n        r\n        )\n        −\n        \n          ϕ\n          \n            m\n            +\n            1\n          \n        \n        (\n        r\n        )\n      \n    \n    {\\displaystyle \\mathrm {ApEn} (m,r,N)(u)=\\phi ^{m}(r)-\\phi ^{m+1}(r)}\n  \n\nParameter selection\nTypically, choose \n  \n    \n      \n        m\n        =\n        2\n      \n    \n    {\\displaystyle m=2}\n  \n or \n  \n    \n      \n        m\n        =\n        3\n      \n    \n    {\\displaystyle m=3}\n  \n, whereas \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n depends greatly on the application.\nAn implementation on Physionet, which is based on Pincus, use \n  \n    \n      \n        d\n        [\n        \n          x\n        \n        (\n        i\n        )\n        ,\n        \n          x\n        \n        (\n        j\n        )\n        ]\n        <\n        r\n      \n    \n    {\\displaystyle d[\\mathbf {x} (i),\\mathbf {x} (j)]<r}\n  \n instead of \n  \n    \n      \n        d\n        [\n        \n          x\n        \n        (\n        i\n        )\n        ,\n        \n          x\n        \n        (\n        j\n        )\n        ]\n        ≤\n        r\n      \n    \n    {\\displaystyle d[\\mathbf {x} (i),\\mathbf {x} (j)]\\leq r}\n  \n in Step 4. While a concern for artificially constructed examples, it is usually not a concern in practice.\n\nExample\nConsider a sequence of \n  \n    \n      \n        N\n        =\n        51\n      \n    \n    {\\displaystyle N=51}\n  \n samples of heart rate equally spaced in time:\n\n  \n    \n      \n         \n        \n          S\n          \n            N\n          \n        \n        =\n        {\n        85\n        ,\n        80\n        ,\n        89\n        ,\n        85\n        ,\n        80\n        ,\n        89\n        ,\n        …\n        }\n      \n    \n    {\\displaystyle \\ S_{N}=\\{85,80,89,85,80,89,\\ldots \\}}\n  \n\nNote the sequence is periodic with a period of 3. Let's choose \n  \n    \n      \n        m\n        =\n        2\n      \n    \n    {\\displaystyle m=2}\n  \n and \n  \n    \n      \n        r\n        =\n        3\n      \n    \n    {\\displaystyle r=3}\n  \n (the values of \n  \n    \n      \n        m\n      \n    \n    {\\displaystyle m}\n  \n and \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n can be varied without affecting the result).\nForm a sequence of vectors: \n\n  \n    \n      \n        \n          \n            \n              \n                \n                  x\n                \n                (\n                1\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                1\n                )\n                 \n                u\n                (\n                2\n                )\n                ]\n                =\n                [\n                85\n                 \n                80\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                2\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                2\n                )\n                 \n                u\n                (\n                3\n                )\n                ]\n                =\n                [\n                80\n                 \n                89\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                3\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                3\n                )\n                 \n                u\n                (\n                4\n                )\n                ]\n                =\n                [\n                89\n                 \n                85\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                4\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                4\n                )\n                 \n                u\n                (\n                5\n                )\n                ]\n                =\n                [\n                85\n                 \n                80\n                ]\n              \n            \n            \n              \n              \n                 \n                 \n                ⋮\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\mathbf {x} (1)&=[u(1)\\ u(2)]=[85\\ 80]\\\\\\mathbf {x} (2)&=[u(2)\\ u(3)]=[80\\ 89]\\\\\\mathbf {x} (3)&=[u(3)\\ u(4)]=[89\\ 85]\\\\\\mathbf {x} (4)&=[u(4)\\ u(5)]=[85\\ 80]\\\\&\\ \\ \\vdots \\end{aligned}}}\n  \n\nDistance is calculated repeatedly as follows. In the first calculation,\n\n  \n    \n      \n         \n        d\n        [\n        \n          x\n        \n        (\n        1\n        )\n        ,\n        \n          x\n        \n        (\n        1\n        )\n        ]\n        =\n        \n          max\n          \n            k\n          \n        \n        \n          |\n        \n        \n          x\n        \n        (\n        1\n        \n          )\n          \n            k\n          \n        \n        −\n        \n          x\n        \n        (\n        1\n        \n          )\n          \n            k\n          \n        \n        \n          |\n        \n        =\n        0\n      \n    \n    {\\displaystyle \\ d[\\mathbf {x} (1),\\mathbf {x} (1)]=\\max _{k}|\\mathbf {x} (1)_{k}-\\mathbf {x} (1)_{k}|=0}\n  \n which is less than \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n.\nIn the second calculation, note that \n  \n    \n      \n        \n          |\n        \n        u\n        (\n        2\n        )\n        −\n        u\n        (\n        3\n        )\n        \n          |\n        \n        >\n        \n          |\n        \n        u\n        (\n        1\n        )\n        −\n        u\n        (\n        2\n        )\n        \n          |\n        \n      \n    \n    {\\displaystyle |u(2)-u(3)|>|u(1)-u(2)|}\n  \n, so\n\n  \n    \n      \n         \n        d\n        [\n        \n          x\n        \n        (\n        1\n        )\n        ,\n        \n          x\n        \n        (\n        2\n        )\n        ]\n        =\n        \n          max\n          \n            k\n          \n        \n        \n          |\n        \n        \n          x\n        \n        (\n        1\n        \n          )\n          \n            k\n          \n        \n        −\n        \n          x\n        \n        (\n        2\n        \n          )\n          \n            k\n          \n        \n        \n          |\n        \n        =\n        \n          |\n        \n        u\n        (\n        2\n        )\n        −\n        u\n        (\n        3\n        )\n        \n          |\n        \n        =\n        9\n      \n    \n    {\\displaystyle \\ d[\\mathbf {x} (1),\\mathbf {x} (2)]=\\max _{k}|\\mathbf {x} (1)_{k}-\\mathbf {x} (2)_{k}|=|u(2)-u(3)|=9}\n  \n which is greater than \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n.\nSimilarly,\n\n  \n    \n      \n        \n          \n            \n              \n                d\n                [\n                \n                  x\n                \n                (\n                1\n                )\n              \n              \n                \n                ,\n                \n                  x\n                \n                (\n                3\n                )\n                ]\n                =\n                \n                  |\n                \n                u\n                (\n                2\n                )\n                −\n                u\n                (\n                4\n                )\n                \n                  |\n                \n                =\n                5\n                >\n                r\n              \n            \n            \n              \n                d\n                [\n                \n                  x\n                \n                (\n                1\n                )\n              \n              \n                \n                ,\n                \n                  x\n                \n                (\n                4\n                )\n                ]\n                =\n                \n                  |\n                \n                u\n                (\n                1\n                )\n                −\n                u\n                (\n                4\n                )\n                \n                  |\n                \n                =\n                \n                  |\n                \n                u\n                (\n                2\n                )\n                −\n                u\n                (\n                5\n                )\n                \n                  |\n                \n                =\n                0\n                <\n                r\n              \n            \n            \n              \n              \n                \n                ⋮\n              \n            \n            \n              \n                d\n                [\n                \n                  x\n                \n                (\n                1\n                )\n              \n              \n                \n                ,\n                \n                  x\n                \n                (\n                j\n                )\n                ]\n                =\n                ⋯\n              \n            \n            \n              \n              \n                \n                ⋮\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}d[\\mathbf {x} (1)&,\\mathbf {x} (3)]=|u(2)-u(4)|=5>r\\\\d[\\mathbf {x} (1)&,\\mathbf {x} (4)]=|u(1)-u(4)|=|u(2)-u(5)|=0<r\\\\&\\vdots \\\\d[\\mathbf {x} (1)&,\\mathbf {x} (j)]=\\cdots \\\\&\\vdots \\\\\\end{aligned}}}\n  \n\nThe result is a total of 17 terms \n  \n    \n      \n        \n          x\n        \n        (\n        j\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (j)}\n  \n such that \n  \n    \n      \n        d\n        [\n        \n          x\n        \n        (\n        1\n        )\n        ,\n        \n          x\n        \n        (\n        j\n        )\n        ]\n        ≤\n        r\n      \n    \n    {\\displaystyle d[\\mathbf {x} (1),\\mathbf {x} (j)]\\leq r}\n  \n. These include \n  \n    \n      \n        \n          x\n        \n        (\n        1\n        )\n        ,\n        \n          x\n        \n        (\n        4\n        )\n        ,\n        \n          x\n        \n        (\n        7\n        )\n        ,\n        …\n        ,\n        \n          x\n        \n        (\n        49\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (1),\\mathbf {x} (4),\\mathbf {x} (7),\\ldots ,\\mathbf {x} (49)}\n  \n. In these cases, \n  \n    \n      \n        \n          C\n          \n            i\n          \n          \n            m\n          \n        \n        (\n        r\n        )\n      \n    \n    {\\displaystyle C_{i}^{m}(r)}\n  \n is\n\n  \n    \n      \n         \n        \n          C\n          \n            1\n          \n          \n            2\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            17\n            50\n          \n        \n      \n    \n    {\\displaystyle \\ C_{1}^{2}(3)={\\frac {17}{50}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            2\n          \n          \n            2\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            17\n            50\n          \n        \n      \n    \n    {\\displaystyle \\ C_{2}^{2}(3)={\\frac {17}{50}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            3\n          \n          \n            2\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            16\n            50\n          \n        \n      \n    \n    {\\displaystyle \\ C_{3}^{2}(3)={\\frac {16}{50}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            4\n          \n          \n            2\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            17\n            50\n          \n        \n         \n        ⋯\n      \n    \n    {\\displaystyle \\ C_{4}^{2}(3)={\\frac {17}{50}}\\ \\cdots }\n  \n\nNote in Step 4, \n  \n    \n      \n        1\n        ≤\n        i\n        ≤\n        n\n      \n    \n    {\\displaystyle 1\\leq i\\leq n}\n  \n for \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (i)}\n  \n. So the terms \n  \n    \n      \n        \n          x\n        \n        (\n        j\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (j)}\n  \n such that \n  \n    \n      \n        d\n        [\n        \n          x\n        \n        (\n        3\n        )\n        ,\n        \n          x\n        \n        (\n        j\n        )\n        ]\n        ≤\n        r\n      \n    \n    {\\displaystyle d[\\mathbf {x} (3),\\mathbf {x} (j)]\\leq r}\n  \n include \n  \n    \n      \n        \n          x\n        \n        (\n        3\n        )\n        ,\n        \n          x\n        \n        (\n        6\n        )\n        ,\n        \n          x\n        \n        (\n        9\n        )\n        ,\n        …\n        ,\n        \n          x\n        \n        (\n        48\n        )\n      \n    \n    {\\displaystyle \\mathbf {x} (3),\\mathbf {x} (6),\\mathbf {x} (9),\\ldots ,\\mathbf {x} (48)}\n  \n, and the total number is 16.\nAt the end of these calculations, we have\n\n  \n    \n      \n        \n          ϕ\n          \n            2\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            1\n            50\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            50\n          \n        \n        log\n        ⁡\n        (\n        \n          C\n          \n            i\n          \n          \n            2\n          \n        \n        (\n        3\n        )\n        )\n        ≈\n        −\n        1.0982\n      \n    \n    {\\displaystyle \\phi ^{2}(3)={1 \\over 50}\\sum _{i=1}^{50}\\log(C_{i}^{2}(3))\\approx -1.0982}\n  \n\nThen we repeat the above steps for \n  \n    \n      \n        m\n        =\n        3\n      \n    \n    {\\displaystyle m=3}\n  \n. First form a sequence of vectors: \n\n  \n    \n      \n        \n          \n            \n              \n                \n                  x\n                \n                (\n                1\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                1\n                )\n                 \n                u\n                (\n                2\n                )\n                 \n                u\n                (\n                3\n                )\n                ]\n                =\n                [\n                85\n                 \n                80\n                 \n                89\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                2\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                2\n                )\n                 \n                u\n                (\n                3\n                )\n                 \n                u\n                (\n                4\n                )\n                ]\n                =\n                [\n                80\n                 \n                89\n                 \n                85\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                3\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                3\n                )\n                 \n                u\n                (\n                4\n                )\n                 \n                u\n                (\n                5\n                )\n                ]\n                =\n                [\n                89\n                 \n                85\n                 \n                80\n                ]\n              \n            \n            \n              \n                \n                  x\n                \n                (\n                4\n                )\n              \n              \n                \n                =\n                [\n                u\n                (\n                4\n                )\n                 \n                u\n                (\n                5\n                )\n                 \n                u\n                (\n                6\n                )\n                ]\n                =\n                [\n                85\n                 \n                80\n                 \n                89\n                ]\n              \n            \n            \n              \n              \n                 \n                 \n                ⋮\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\mathbf {x} (1)&=[u(1)\\ u(2)\\ u(3)]=[85\\ 80\\ 89]\\\\\\mathbf {x} (2)&=[u(2)\\ u(3)\\ u(4)]=[80\\ 89\\ 85]\\\\\\mathbf {x} (3)&=[u(3)\\ u(4)\\ u(5)]=[89\\ 85\\ 80]\\\\\\mathbf {x} (4)&=[u(4)\\ u(5)\\ u(6)]=[85\\ 80\\ 89]\\\\&\\ \\ \\vdots \\end{aligned}}}\n  \n\nBy calculating distances between vector \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n        ,\n        \n          x\n        \n        (\n        j\n        )\n        ,\n        1\n        ≤\n        i\n        ≤\n        49\n      \n    \n    {\\displaystyle \\mathbf {x} (i),\\mathbf {x} (j),1\\leq i\\leq 49}\n  \n, we find the vectors satisfying the filtering level have the following characteristic:\n\n  \n    \n      \n        d\n        [\n        \n          x\n        \n        (\n        i\n        )\n        ,\n        \n          x\n        \n        (\n        i\n        +\n        3\n        )\n        ]\n        =\n        0\n        <\n        r\n      \n    \n    {\\displaystyle d[\\mathbf {x} (i),\\mathbf {x} (i+3)]=0<r}\n  \n\nTherefore,  \n\n  \n    \n      \n         \n        \n          C\n          \n            1\n          \n          \n            3\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            17\n            49\n          \n        \n      \n    \n    {\\displaystyle \\ C_{1}^{3}(3)={\\frac {17}{49}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            2\n          \n          \n            3\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            16\n            49\n          \n        \n      \n    \n    {\\displaystyle \\ C_{2}^{3}(3)={\\frac {16}{49}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            3\n          \n          \n            3\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            16\n            49\n          \n        \n      \n    \n    {\\displaystyle \\ C_{3}^{3}(3)={\\frac {16}{49}}}\n  \n\n  \n    \n      \n         \n        \n          C\n          \n            4\n          \n          \n            3\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            17\n            49\n          \n        \n         \n        ⋯\n      \n    \n    {\\displaystyle \\ C_{4}^{3}(3)={\\frac {17}{49}}\\ \\cdots }\n  \n\nAt the end of these calculations, we have\n\n  \n    \n      \n        \n          ϕ\n          \n            3\n          \n        \n        (\n        3\n        )\n        =\n        \n          \n            1\n            49\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            49\n          \n        \n        log\n        ⁡\n        (\n        \n          C\n          \n            i\n          \n          \n            3\n          \n        \n        (\n        3\n        )\n        )\n        ≈\n        −\n        1.0982\n      \n    \n    {\\displaystyle \\phi ^{3}(3)={1 \\over 49}\\sum _{i=1}^{49}\\log(C_{i}^{3}(3))\\approx -1.0982}\n  \n\nFinally,\n\n  \n    \n      \n        \n          A\n          p\n          E\n          n\n        \n        =\n        \n          ϕ\n          \n            2\n          \n        \n        (\n        3\n        )\n        −\n        \n          ϕ\n          \n            3\n          \n        \n        (\n        3\n        )\n        ≈\n        0.000010997\n      \n    \n    {\\displaystyle \\mathrm {ApEn} =\\phi ^{2}(3)-\\phi ^{3}(3)\\approx 0.000010997}\n  \n\nThe value is very small, so it implies the sequence is regular and predictable, which is consistent with the observation.\n\nPython implementation\nMATLAB implementation\nFast Approximate Entropy from MatLab Central\napproximateEntropy\n\nInterpretation\nThe presence of repetitive patterns of fluctuation in a time series renders it more predictable than a time series in which such patterns are absent. ApEn reflects the likelihood that similar patterns of observations will not be followed by additional similar observations. A time series containing many repetitive patterns has a relatively small ApEn; a less predictable process has a higher ApEn.\n\nAdvantages\nThe advantages of ApEn include:\n\nLower computational demand. ApEn can be designed to work for small data samples (\n  \n    \n      \n        N\n        <\n        50\n      \n    \n    {\\displaystyle N<50}\n  \n points) and can be applied in real time.\nLess effect from noise. If data is noisy, the ApEn measure can be compared to the noise level in the data to determine what quality of true information may be present in the data.\n\nLimitations\nThe ApEn algorithm counts each sequence as matching itself to avoid the occurrence of \n  \n    \n      \n        log\n        ⁡\n        (\n        0\n        )\n      \n    \n    {\\displaystyle \\log(0)}\n  \n in the calculations. This step might introduce bias in ApEn, which causes ApEn to have two poor properties in practice: \n\nApEn is heavily dependent on the record length and is uniformly lower than expected for short records.\nIt lacks relative consistency. That is, if ApEn of one data set is higher than that of another, it should, but does not, remain higher for all conditions tested.\n\nApplications\nApEn has been applied to classify electroencephalography (EEG) in psychiatric diseases, such as schizophrenia, epilepsy, and addiction.\n\nSee also\nRecurrence quantification analysis\nSample entropy\n\n\n== References ==\n",
  "categories": [
    "Category:Articles with example Python (programming language) code",
    "Category:Articles with short description",
    "Category:Entropy and information",
    "Category:Short description matches Wikidata",
    "Category:Time series"
  ],
  "archived_date": "20241221_183014",
  "source_url": "https://en.wikipedia.org/wiki/Approximate_entropy"
}