{
  "title": "Simpson's rule",
  "summary": "In numerical integration, Simpson's rules are several approximations for definite integrals, named after Thomas Simpson (1710–1761).\nThe most basic of these rules, called Simpson's 1/3 rule, or just Simpson's rule, reads\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            \n              b\n              −\n              a\n ",
  "content": "---\ntitle: Simpson's rule\nurl: https://en.wikipedia.org/wiki/Simpson%27s_rule\nlanguage: en\ncategories: [\"Category:Articles containing German-language text\", \"Category:Articles with example Python (programming language) code\", \"Category:Articles with example R code\", \"Category:Articles with short description\", \"Category:Integral calculus\", \"Category:Numerical analysis\", \"Category:Numerical integration (quadrature)\", \"Category:Short description is different from Wikidata\", \"Category:Use dmy dates from January 2020\", \"Category:Wikipedia articles incorporating text from PlanetMath\"]\nreferences: 0\nlast_modified: 2024-12-19T13:43:30Z\n---\n\n# Simpson's rule\n\n## Summary\n\nIn numerical integration, Simpson's rules are several approximations for definite integrals, named after Thomas Simpson (1710–1761).\nThe most basic of these rules, called Simpson's 1/3 rule, or just Simpson's rule, reads\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            \n              b\n              −\n              a\n \n\n## Full Content\n\nIn numerical integration, Simpson's rules are several approximations for definite integrals, named after Thomas Simpson (1710–1761).\nThe most basic of these rules, called Simpson's 1/3 rule, or just Simpson's rule, reads\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            \n              b\n              −\n              a\n            \n            6\n          \n        \n        \n          [\n          \n            f\n            (\n            a\n            )\n            +\n            4\n            f\n            \n              (\n              \n                \n                  \n                    a\n                    +\n                    b\n                  \n                  2\n                \n              \n              )\n            \n            +\n            f\n            (\n            b\n            )\n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle \\int _{a}^{b}f(x)\\,dx\\approx {\\frac {b-a}{6}}\\left[f(a)+4f\\left({\\frac {a+b}{2}}\\right)+f(b)\\right].}\n  \n\nIn German and some other languages, it is named after Johannes Kepler, who derived it in 1615 after seeing it used for wine barrels (barrel rule, Keplersche Fassregel). The approximate equality in the rule becomes exact if f is a polynomial up to and including 3rd degree.\nIf the 1/3 rule is applied to n equal subdivisions of the integration range [a, b], one obtains the composite Simpson's 1/3 rule. Points inside the integration range are given alternating weights 4/3 and 2/3.\nSimpson's 3/8 rule, also called Simpson's second rule, requires one more function evaluation inside the integration range and gives lower error bounds, but does not improve the order of the error.\nIf the 3/8 rule is applied to n equal subdivisions of the integration range [a, b], one obtains the composite Simpson's 3/8 rule.\nSimpson's 1/3 and 3/8 rules are two special cases of closed Newton–Cotes formulas.\nIn naval architecture and ship stability estimation, there also exists Simpson's third rule, which has no special importance in general numerical analysis, see Simpson's rules (ship stability).\n\nSimpson's 1/3 rule\nSimpson's 1/3 rule, also simply called Simpson's rule, is a method for numerical integration proposed by Thomas Simpson. It is based upon a quadratic interpolation and is the composite Simpson's 1/3 rule evaluated for \n  \n    \n      \n        n\n        =\n        2\n      \n    \n    {\\displaystyle n=2}\n  \n. Simpson's 1/3 rule is as follows:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  ∫\n                  \n                    a\n                  \n                  \n                    b\n                  \n                \n                f\n                (\n                x\n                )\n                \n                d\n                x\n              \n              \n                \n                ≈\n                \n                  \n                    \n                      b\n                      −\n                      a\n                    \n                    6\n                  \n                \n                \n                  [\n                  \n                    f\n                    (\n                    a\n                    )\n                    +\n                    4\n                    f\n                    \n                      (\n                      \n                        \n                          \n                            a\n                            +\n                            b\n                          \n                          2\n                        \n                      \n                      )\n                    \n                    +\n                    f\n                    (\n                    b\n                    )\n                  \n                  ]\n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    1\n                    3\n                  \n                \n                h\n                \n                  [\n                  \n                    f\n                    (\n                    a\n                    )\n                    +\n                    4\n                    f\n                    \n                      (\n                      \n                        a\n                        +\n                        h\n                      \n                      )\n                    \n                    +\n                    f\n                    (\n                    b\n                    )\n                  \n                  ]\n                \n                ,\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\int _{a}^{b}f(x)\\,dx&\\approx {\\frac {b-a}{6}}\\left[f(a)+4f\\left({\\frac {a+b}{2}}\\right)+f(b)\\right]\\\\&={\\frac {1}{3}}h\\left[f(a)+4f\\left(a+h\\right)+f(b)\\right],\\end{aligned}}}\n  \n\nwhere \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle h=(b-a)/n}\n  \n is the step size for \n  \n    \n      \n        n\n        =\n        2\n      \n    \n    {\\displaystyle n=2}\n  \n.\nThe error in approximating an integral by Simpson's rule for \n  \n    \n      \n        n\n        =\n        2\n      \n    \n    {\\displaystyle n=2}\n  \n is\n\n  \n    \n      \n        −\n        \n          \n            1\n            90\n          \n        \n        \n          h\n          \n            5\n          \n        \n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        =\n        −\n        \n          \n            \n              (\n              b\n              −\n              a\n              \n                )\n                \n                  5\n                \n              \n            \n            2880\n          \n        \n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        ,\n      \n    \n    {\\displaystyle -{\\frac {1}{90}}h^{5}f^{(4)}(\\xi )=-{\\frac {(b-a)^{5}}{2880}}f^{(4)}(\\xi ),}\n  \n\nwhere \n  \n    \n      \n        ξ\n      \n    \n    {\\displaystyle \\xi }\n  \n (the Greek letter xi) is some number between \n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n  \n and \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n.\nThe error is asymptotically proportional to \n  \n    \n      \n        (\n        b\n        −\n        a\n        \n          )\n          \n            5\n          \n        \n      \n    \n    {\\displaystyle (b-a)^{5}}\n  \n. However, the above derivations suggest an error proportional to \n  \n    \n      \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n      \n    \n    {\\displaystyle (b-a)^{4}}\n  \n. Simpson's rule gains an extra order because the points at which the integrand is evaluated are distributed symmetrically in the interval \n  \n    \n      \n        [\n        a\n        ,\n         \n        b\n        ]\n      \n    \n    {\\displaystyle [a,\\ b]}\n  \n.\nSince the error term is proportional to the fourth derivative of \n  \n    \n      \n        f\n      \n    \n    {\\displaystyle f}\n  \n at \n  \n    \n      \n        ξ\n      \n    \n    {\\displaystyle \\xi }\n  \n, this shows that Simpson's rule provides exact results for any polynomial \n  \n    \n      \n        f\n      \n    \n    {\\displaystyle f}\n  \n of degree three or less, since the fourth derivative of such a polynomial is zero at all points. Another way to see this result is to note that any interpolating cubic polynomial can be expressed as the sum of the unique interpolating quadratic polynomial plus an arbitrarily scaled cubic polynomial that vanishes at all three points in the interval, and the integral of this second term vanishes because it is odd within the interval.\nIf the second derivative \n  \n    \n      \n        \n          f\n          ″\n        \n      \n    \n    {\\displaystyle f''}\n  \n exists and is convex in the interval \n  \n    \n      \n        (\n        a\n        ,\n         \n        b\n        )\n      \n    \n    {\\displaystyle (a,\\ b)}\n  \n, then\n\n  \n    \n      \n        (\n        b\n        −\n        a\n        )\n        f\n        \n          (\n          \n            \n              \n                a\n                +\n                b\n              \n              2\n            \n          \n          )\n        \n        +\n        \n          \n            1\n            3\n          \n        \n        \n          \n            (\n            \n              \n                \n                  b\n                  −\n                  a\n                \n                2\n              \n            \n            )\n          \n          \n            3\n          \n        \n        \n          f\n          ″\n        \n        \n          (\n          \n            \n              \n                a\n                +\n                b\n              \n              2\n            \n          \n          )\n        \n        ≤\n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≤\n        \n          \n            \n              b\n              −\n              a\n            \n            6\n          \n        \n        \n          [\n          \n            f\n            (\n            a\n            )\n            +\n            4\n            f\n            \n              (\n              \n                \n                  \n                    a\n                    +\n                    b\n                  \n                  2\n                \n              \n              )\n            \n            +\n            f\n            (\n            b\n            )\n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle (b-a)f\\left({\\frac {a+b}{2}}\\right)+{\\frac {1}{3}}\\left({\\frac {b-a}{2}}\\right)^{3}f''\\left({\\frac {a+b}{2}}\\right)\\leq \\int _{a}^{b}f(x)\\,dx\\leq {\\frac {b-a}{6}}\\left[f(a)+4f\\left({\\frac {a+b}{2}}\\right)+f(b)\\right].}\n\nDerivations\nQuadratic interpolation\nOne derivation replaces the integrand \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n by the quadratic polynomial (i.e. parabola) \n  \n    \n      \n        P\n        (\n        x\n        )\n      \n    \n    {\\displaystyle P(x)}\n  \n that takes the same values as \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n at the end points \n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n  \n and \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n and the midpoint \n  \n    \n      \n        m\n        =\n        (\n        a\n        +\n        b\n        )\n        \n          /\n        \n        2\n      \n    \n    {\\displaystyle m=(a+b)/2}\n  \n. One can use Lagrange polynomial interpolation to find an expression for this polynomial,\n\n  \n    \n      \n        P\n        (\n        x\n        )\n        =\n        f\n        (\n        a\n        )\n        \n          \n            \n              (\n              x\n              −\n              m\n              )\n              (\n              x\n              −\n              b\n              )\n            \n            \n              (\n              a\n              −\n              m\n              )\n              (\n              a\n              −\n              b\n              )\n            \n          \n        \n        +\n        f\n        (\n        m\n        )\n        \n          \n            \n              (\n              x\n              −\n              a\n              )\n              (\n              x\n              −\n              b\n              )\n            \n            \n              (\n              m\n              −\n              a\n              )\n              (\n              m\n              −\n              b\n              )\n            \n          \n        \n        +\n        f\n        (\n        b\n        )\n        \n          \n            \n              (\n              x\n              −\n              a\n              )\n              (\n              x\n              −\n              m\n              )\n            \n            \n              (\n              b\n              −\n              a\n              )\n              (\n              b\n              −\n              m\n              )\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle P(x)=f(a){\\frac {(x-m)(x-b)}{(a-m)(a-b)}}+f(m){\\frac {(x-a)(x-b)}{(m-a)(m-b)}}+f(b){\\frac {(x-a)(x-m)}{(b-a)(b-m)}}.}\n  \n\nUsing integration by substitution, one can show that\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        P\n        (\n        x\n        )\n        \n        d\n        x\n        =\n        \n          \n            \n              b\n              −\n              a\n            \n            6\n          \n        \n        \n          [\n          \n            f\n            (\n            a\n            )\n            +\n            4\n            f\n            \n              (\n              \n                \n                  \n                    a\n                    +\n                    b\n                  \n                  2\n                \n              \n              )\n            \n            +\n            f\n            (\n            b\n            )\n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle \\int _{a}^{b}P(x)\\,dx={\\frac {b-a}{6}}\\left[f(a)+4f\\left({\\frac {a+b}{2}}\\right)+f(b)\\right].}\n  \n\nIntroducing the step size \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        2\n      \n    \n    {\\displaystyle h=(b-a)/2}\n  \n, this is also commonly written as\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        P\n        (\n        x\n        )\n        \n        d\n        x\n        =\n        \n          \n            1\n            3\n          \n        \n        h\n        \n          [\n          \n            f\n            (\n            a\n            )\n            +\n            4\n            f\n            \n              (\n              \n                a\n                +\n                h\n              \n              )\n            \n            +\n            f\n            (\n            b\n            )\n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle \\int _{a}^{b}P(x)\\,dx={\\frac {1}{3}}h\\left[f(a)+4f\\left(a+h\\right)+f(b)\\right].}\n  \n\nBecause of the \n  \n    \n      \n        1\n        \n          /\n        \n        3\n      \n    \n    {\\displaystyle 1/3}\n  \n factor, Simpson's rule is also referred to as \"Simpson's 1/3 rule\" (see below for generalization).\n\nAveraging the midpoint and the trapezoidal rules\nAnother derivation constructs Simpson's rule from two simpler approximations: the midpoint rule\n\n  \n    \n      \n        M\n        =\n        (\n        b\n        −\n        a\n        )\n        f\n        \n          (\n          \n            \n              \n                a\n                +\n                b\n              \n              2\n            \n          \n          )\n        \n      \n    \n    {\\displaystyle M=(b-a)f\\left({\\frac {a+b}{2}}\\right)}\n  \n\nand the trapezoidal rule\n\n  \n    \n      \n        T\n        =\n        \n          \n            1\n            2\n          \n        \n        (\n        b\n        −\n        a\n        )\n        \n          \n            (\n          \n        \n        f\n        (\n        a\n        )\n        +\n        f\n        (\n        b\n        )\n        \n          \n            )\n          \n        \n        .\n      \n    \n    {\\displaystyle T={\\frac {1}{2}}(b-a){\\big (}f(a)+f(b){\\big )}.}\n  \n\nThe errors in these approximations are\n\n  \n    \n      \n        \n          \n            1\n            24\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            3\n          \n        \n        \n          f\n          ″\n        \n        (\n        a\n        )\n        +\n        O\n        \n          \n            (\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle {\\frac {1}{24}}(b-a)^{3}f''(a)+O{\\big (}(b-a)^{4}{\\big )}}\n  \n\nand\n\n  \n    \n      \n        −\n        \n          \n            1\n            12\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            3\n          \n        \n        \n          f\n          ″\n        \n        (\n        a\n        )\n        +\n        O\n        \n          \n            (\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle -{\\frac {1}{12}}(b-a)^{3}f''(a)+O{\\big (}(b-a)^{4}{\\big )}}\n  \n\nrespectively, where \n  \n    \n      \n        O\n        \n          \n            (\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle O{\\big (}(b-a)^{4}{\\big )}}\n  \n denotes a term asymptotically proportional to \n  \n    \n      \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n      \n    \n    {\\displaystyle (b-a)^{4}}\n  \n. The two \n  \n    \n      \n        O\n        \n          \n            (\n          \n        \n        (\n        b\n        −\n        a\n        \n          )\n          \n            4\n          \n        \n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle O{\\big (}(b-a)^{4}{\\big )}}\n  \n terms are not equal; see Big O notation for more details. It follows from the above formulas for the errors of the midpoint and trapezoidal rule that the leading error term vanishes if we take the weighted average\n\n  \n    \n      \n        \n          \n            \n              2\n              M\n              +\n              T\n            \n            3\n          \n        \n        .\n      \n    \n    {\\displaystyle {\\frac {2M+T}{3}}.}\n  \n\nThis weighted average is exactly Simpson's rule.\nUsing another approximation (for example, the trapezoidal rule with twice as many points), it is possible to take a suitable weighted average and eliminate another error term. This is Romberg's method.\n\nUndetermined coefficients\nThe third derivation starts from the ansatz\n\n  \n    \n      \n        \n          \n            1\n            \n              b\n              −\n              a\n            \n          \n        \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        α\n        f\n        (\n        a\n        )\n        +\n        β\n        f\n        \n          (\n          \n            \n              \n                a\n                +\n                b\n              \n              2\n            \n          \n          )\n        \n        +\n        γ\n        f\n        (\n        b\n        )\n        .\n      \n    \n    {\\displaystyle {\\frac {1}{b-a}}\\int _{a}^{b}f(x)\\,dx\\approx \\alpha f(a)+\\beta f\\left({\\frac {a+b}{2}}\\right)+\\gamma f(b).}\n  \n\nThe coefficients α, β and γ can be fixed by requiring that this approximation be exact for all quadratic polynomials. This yields Simpson's rule. (This derivation is essentially a less rigorous version of the quadratic interpolation derivation, where one saves significant calculation effort by guessing the correct functional form.)\n\nComposite Simpson's 1/3 rule\nIf the interval of integration \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n is in some sense \"small\", then Simpson's rule with \n  \n    \n      \n        n\n        =\n        2\n      \n    \n    {\\displaystyle n=2}\n  \n subintervals will provide an adequate approximation to the exact integral. By \"small\" we mean that the function being integrated is relatively smooth over the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n. For such a function, a smooth quadratic interpolant like the one used in Simpson's rule will give good results.\nHowever, it is often the case that the function we are trying to integrate is not smooth over the interval. Typically, this means that either the function is highly oscillatory or lacks derivatives at certain points. In these cases, Simpson's rule may give very poor results. One common way of handling this problem is by breaking up the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n into \n  \n    \n      \n        n\n        >\n        2\n      \n    \n    {\\displaystyle n>2}\n  \n small subintervals. Simpson's rule is then applied to each subinterval, with the results being summed to produce an approximation for the integral over the entire interval. This sort of approach is termed the composite Simpson's 1/3 rule, or just composite Simpson's rule.\nSuppose that the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n is split up into \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n subintervals, with \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n an even number. Then, the composite Simpson's rule is given by\nDividing the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n into \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n subintervals of length \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle h=(b-a)/n}\n  \n and introducing the points \n  \n    \n      \n        \n          x\n          \n            i\n          \n        \n        =\n        a\n        +\n        i\n        h\n      \n    \n    {\\displaystyle x_{i}=a+ih}\n  \n for \n  \n    \n      \n        0\n        ≤\n        i\n        ≤\n        n\n      \n    \n    {\\displaystyle 0\\leq i\\leq n}\n  \n (in particular, \n  \n    \n      \n        \n          x\n          \n            0\n          \n        \n        =\n        a\n      \n    \n    {\\displaystyle x_{0}=a}\n  \n and \n  \n    \n      \n        \n          x\n          \n            n\n          \n        \n        =\n        b\n      \n    \n    {\\displaystyle x_{n}=b}\n  \n), we have\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  ∫\n                  \n                    a\n                  \n                  \n                    b\n                  \n                \n                f\n                (\n                x\n                )\n                \n                d\n                x\n              \n              \n                \n                ≈\n                \n                  \n                    1\n                    3\n                  \n                \n                h\n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                    \n                      /\n                    \n                    2\n                  \n                \n                \n                  \n                    [\n                  \n                \n                f\n                (\n                \n                  x\n                  \n                    2\n                    i\n                    −\n                    2\n                  \n                \n                )\n                +\n                4\n                f\n                (\n                \n                  x\n                  \n                    2\n                    i\n                    −\n                    1\n                  \n                \n                )\n                +\n                f\n                (\n                \n                  x\n                  \n                    2\n                    i\n                  \n                \n                )\n                \n                  \n                    ]\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    1\n                    3\n                  \n                \n                h\n                \n                  \n                    [\n                  \n                \n                f\n                (\n                \n                  x\n                  \n                    0\n                  \n                \n                )\n                +\n                4\n                f\n                (\n                \n                  x\n                  \n                    1\n                  \n                \n                )\n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    2\n                  \n                \n                )\n                +\n                4\n                f\n                (\n                \n                  x\n                  \n                    3\n                  \n                \n                )\n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    4\n                  \n                \n                )\n                +\n                ⋯\n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    n\n                    −\n                    2\n                  \n                \n                )\n                +\n                4\n                f\n                (\n                \n                  x\n                  \n                    n\n                    −\n                    1\n                  \n                \n                )\n                +\n                f\n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                )\n                \n                  \n                    ]\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    1\n                    3\n                  \n                \n                h\n                \n                  [\n                  \n                    f\n                    (\n                    \n                      x\n                      \n                        0\n                      \n                    \n                    )\n                    +\n                    4\n                    \n                      ∑\n                      \n                        i\n                        =\n                        1\n                      \n                      \n                        n\n                        \n                          /\n                        \n                        2\n                      \n                    \n                    f\n                    (\n                    \n                      x\n                      \n                        2\n                        i\n                        −\n                        1\n                      \n                    \n                    )\n                    +\n                    2\n                    \n                      ∑\n                      \n                        i\n                        =\n                        1\n                      \n                      \n                        n\n                        \n                          /\n                        \n                        2\n                        −\n                        1\n                      \n                    \n                    f\n                    (\n                    \n                      x\n                      \n                        2\n                        i\n                      \n                    \n                    )\n                    +\n                    f\n                    (\n                    \n                      x\n                      \n                        n\n                      \n                    \n                    )\n                  \n                  ]\n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\int _{a}^{b}f(x)\\,dx&\\approx {\\frac {1}{3}}h\\sum _{i=1}^{n/2}{\\big [}f(x_{2i-2})+4f(x_{2i-1})+f(x_{2i}){\\big ]}\\\\&={\\frac {1}{3}}h{\\big [}f(x_{0})+4f(x_{1})+2f(x_{2})+4f(x_{3})+2f(x_{4})+\\dots +2f(x_{n-2})+4f(x_{n-1})+f(x_{n}){\\big ]}\\\\&={\\frac {1}{3}}h\\left[f(x_{0})+4\\sum _{i=1}^{n/2}f(x_{2i-1})+2\\sum _{i=1}^{n/2-1}f(x_{2i})+f(x_{n})\\right].\\end{aligned}}}\n  \n\nThis composite rule with \n  \n    \n      \n        n\n        =\n        2\n      \n    \n    {\\displaystyle n=2}\n  \n corresponds with the regular Simpson's rule of the preceding section.\nThe error committed by the composite Simpson's rule is\n\n  \n    \n      \n        −\n        \n          \n            1\n            180\n          \n        \n        \n          h\n          \n            4\n          \n        \n        (\n        b\n        −\n        a\n        )\n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        ,\n      \n    \n    {\\displaystyle -{\\frac {1}{180}}h^{4}(b-a)f^{(4)}(\\xi ),}\n  \n\nwhere \n  \n    \n      \n        ξ\n      \n    \n    {\\displaystyle \\xi }\n  \n is some number between \n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n  \n and \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n, and \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle h=(b-a)/n}\n  \n is the \"step length\". The error is bounded (in absolute value) by\n\n  \n    \n      \n        \n          \n            1\n            180\n          \n        \n        \n          h\n          \n            4\n          \n        \n        (\n        b\n        −\n        a\n        )\n        \n          max\n          \n            ξ\n            ∈\n            [\n            a\n            ,\n            b\n            ]\n          \n        \n        \n          |\n          \n            \n              f\n              \n                (\n                4\n                )\n              \n            \n            (\n            ξ\n            )\n          \n          |\n        \n        .\n      \n    \n    {\\displaystyle {\\frac {1}{180}}h^{4}(b-a)\\max _{\\xi \\in [a,b]}\\left|f^{(4)}(\\xi )\\right|.}\n  \n\nThis formulation splits the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n in subintervals of equal length. In practice, it is often advantageous to use subintervals of different lengths and concentrate the efforts on the places where the integrand is less well-behaved. This leads to the adaptive Simpson's method.\n\nSimpson's 3/8 rule\nSimpson's 3/8 rule, also called Simpson's second rule, is another method for numerical integration proposed by Thomas Simpson. It is based upon a cubic interpolation rather than a quadratic interpolation. Simpson's 3/8 rule is as follows:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  ∫\n                  \n                    a\n                  \n                  \n                    b\n                  \n                \n                f\n                (\n                x\n                )\n                \n                d\n                x\n              \n              \n                \n                ≈\n                \n                  \n                    \n                      b\n                      −\n                      a\n                    \n                    8\n                  \n                \n                \n                  [\n                  \n                    f\n                    (\n                    a\n                    )\n                    +\n                    3\n                    f\n                    \n                      (\n                      \n                        \n                          \n                            2\n                            a\n                            +\n                            b\n                          \n                          3\n                        \n                      \n                      )\n                    \n                    +\n                    3\n                    f\n                    \n                      (\n                      \n                        \n                          \n                            a\n                            +\n                            2\n                            b\n                          \n                          3\n                        \n                      \n                      )\n                    \n                    +\n                    f\n                    (\n                    b\n                    )\n                  \n                  ]\n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    3\n                    8\n                  \n                \n                h\n                \n                  [\n                  \n                    f\n                    (\n                    a\n                    )\n                    +\n                    3\n                    f\n                    \n                      (\n                      \n                        a\n                        +\n                        h\n                      \n                      )\n                    \n                    +\n                    3\n                    f\n                    \n                      (\n                      \n                        a\n                        +\n                        2\n                        h\n                      \n                      )\n                    \n                    +\n                    f\n                    (\n                    b\n                    )\n                  \n                  ]\n                \n                ,\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\int _{a}^{b}f(x)\\,dx&\\approx {\\frac {b-a}{8}}\\left[f(a)+3f\\left({\\frac {2a+b}{3}}\\right)+3f\\left({\\frac {a+2b}{3}}\\right)+f(b)\\right]\\\\&={\\frac {3}{8}}h\\left[f(a)+3f\\left(a+h\\right)+3f\\left(a+2h\\right)+f(b)\\right],\\end{aligned}}}\n  \n\nwhere \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        3\n      \n    \n    {\\displaystyle h=(b-a)/3}\n  \n is the step size.\nThe error of this method is\n\n  \n    \n      \n        −\n        \n          \n            3\n            80\n          \n        \n        \n          h\n          \n            5\n          \n        \n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        =\n        −\n        \n          \n            \n              (\n              b\n              −\n              a\n              \n                )\n                \n                  5\n                \n              \n            \n            6480\n          \n        \n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        ,\n      \n    \n    {\\displaystyle -{\\frac {3}{80}}h^{5}f^{(4)}(\\xi )=-{\\frac {(b-a)^{5}}{6480}}f^{(4)}(\\xi ),}\n  \n\nwhere \n  \n    \n      \n        ξ\n      \n    \n    {\\displaystyle \\xi }\n  \n is some number between \n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n  \n and \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n. Thus, the 3/8 rule is about twice as accurate as the standard method, but it uses one more function value. A composite 3/8 rule also exists, similarly as above.\nA further generalization of this concept for interpolation with arbitrary-degree polynomials are the Newton–Cotes formulas.\n\nComposite Simpson's 3/8 rule\nDividing the interval \n  \n    \n      \n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle [a,b]}\n  \n into \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n subintervals of length \n  \n    \n      \n        h\n        =\n        (\n        b\n        −\n        a\n        )\n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle h=(b-a)/n}\n  \n and introducing the points \n  \n    \n      \n        \n          x\n          \n            i\n          \n        \n        =\n        a\n        +\n        i\n        h\n      \n    \n    {\\displaystyle x_{i}=a+ih}\n  \n for \n  \n    \n      \n        0\n        ≤\n        i\n        ≤\n        n\n      \n    \n    {\\displaystyle 0\\leq i\\leq n}\n  \n (in particular, \n  \n    \n      \n        \n          x\n          \n            0\n          \n        \n        =\n        a\n      \n    \n    {\\displaystyle x_{0}=a}\n  \n and \n  \n    \n      \n        \n          x\n          \n            n\n          \n        \n        =\n        b\n      \n    \n    {\\displaystyle x_{n}=b}\n  \n), we have\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  ∫\n                  \n                    a\n                  \n                  \n                    b\n                  \n                \n                f\n                (\n                x\n                )\n                \n                d\n                x\n              \n              \n                \n                ≈\n                \n                  \n                    3\n                    8\n                  \n                \n                h\n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                    \n                      /\n                    \n                    3\n                  \n                \n                \n                  \n                    [\n                  \n                \n                f\n                (\n                \n                  x\n                  \n                    3\n                    i\n                    −\n                    3\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    3\n                    i\n                    −\n                    2\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    3\n                    i\n                    −\n                    1\n                  \n                \n                )\n                +\n                f\n                (\n                \n                  x\n                  \n                    3\n                    i\n                  \n                \n                )\n                \n                  \n                    ]\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    3\n                    8\n                  \n                \n                h\n                \n                  \n                    [\n                  \n                \n                f\n                (\n                \n                  x\n                  \n                    0\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    1\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    2\n                  \n                \n                )\n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    3\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    4\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    5\n                  \n                \n                )\n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    6\n                  \n                \n                )\n                +\n                …\n              \n            \n            \n              \n              \n                \n                \n                +\n                2\n                f\n                (\n                \n                  x\n                  \n                    n\n                    −\n                    3\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    n\n                    −\n                    2\n                  \n                \n                )\n                +\n                3\n                f\n                (\n                \n                  x\n                  \n                    n\n                    −\n                    1\n                  \n                \n                )\n                +\n                f\n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                )\n                \n                  \n                    ]\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    3\n                    8\n                  \n                \n                h\n                \n                  [\n                  \n                    f\n                    (\n                    \n                      x\n                      \n                        0\n                      \n                    \n                    )\n                    +\n                    3\n                    \n                      ∑\n                      \n                        i\n                        =\n                        1\n                        ,\n                         \n                        3\n                        ∤\n                        i\n                      \n                      \n                        n\n                        −\n                        1\n                      \n                    \n                    f\n                    (\n                    \n                      x\n                      \n                        i\n                      \n                    \n                    )\n                    +\n                    2\n                    \n                      ∑\n                      \n                        i\n                        =\n                        1\n                      \n                      \n                        n\n                        \n                          /\n                        \n                        3\n                        −\n                        1\n                      \n                    \n                    f\n                    (\n                    \n                      x\n                      \n                        3\n                        i\n                      \n                    \n                    )\n                    +\n                    f\n                    (\n                    \n                      x\n                      \n                        n\n                      \n                    \n                    )\n                  \n                  ]\n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\int _{a}^{b}f(x)\\,dx&\\approx {\\frac {3}{8}}h\\sum _{i=1}^{n/3}{\\big [}f(x_{3i-3})+3f(x_{3i-2})+3f(x_{3i-1})+f(x_{3i}){\\big ]}\\\\&={\\frac {3}{8}}h{\\big [}f(x_{0})+3f(x_{1})+3f(x_{2})+2f(x_{3})+3f(x_{4})+3f(x_{5})+2f(x_{6})+\\dots \\\\&\\qquad +2f(x_{n-3})+3f(x_{n-2})+3f(x_{n-1})+f(x_{n}){\\big ]}\\\\&={\\frac {3}{8}}h\\left[f(x_{0})+3\\sum _{i=1,\\ 3\\nmid i}^{n-1}f(x_{i})+2\\sum _{i=1}^{n/3-1}f(x_{3i})+f(x_{n})\\right].\\end{aligned}}}\n  \n\nWhile the remainder for the rule is shown as\n\n  \n    \n      \n        −\n        \n          \n            1\n            80\n          \n        \n        \n          h\n          \n            4\n          \n        \n        (\n        b\n        −\n        a\n        )\n        \n          f\n          \n            (\n            4\n            )\n          \n        \n        (\n        ξ\n        )\n        ,\n      \n    \n    {\\displaystyle -{\\frac {1}{80}}h^{4}(b-a)f^{(4)}(\\xi ),}\n  \n\nwe can only use this if \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n is a multiple of three. The 1/3 rule can be used for the remaining subintervals without changing the order of the error term (conversely, the 3/8 rule can be used with a composite 1/3 rule for odd-numbered subintervals).\n\nAlternative extended Simpson's rule\nThis is another formulation of a composite Simpson's rule: instead of applying Simpson's rule to disjoint segments of the integral to be approximated, Simpson's rule is applied to overlapping segments, yielding\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            1\n            48\n          \n        \n        h\n        \n          [\n          \n            17\n            f\n            (\n            \n              x\n              \n                0\n              \n            \n            )\n            +\n            59\n            f\n            (\n            \n              x\n              \n                1\n              \n            \n            )\n            +\n            43\n            f\n            (\n            \n              x\n              \n                2\n              \n            \n            )\n            +\n            49\n            f\n            (\n            \n              x\n              \n                3\n              \n            \n            )\n            +\n            48\n            \n              ∑\n              \n                i\n                =\n                4\n              \n              \n                n\n                −\n                4\n              \n            \n            f\n            (\n            \n              x\n              \n                i\n              \n            \n            )\n            +\n            49\n            f\n            (\n            \n              x\n              \n                n\n                −\n                3\n              \n            \n            )\n            +\n            43\n            f\n            (\n            \n              x\n              \n                n\n                −\n                2\n              \n            \n            )\n            +\n            59\n            f\n            (\n            \n              x\n              \n                n\n                −\n                1\n              \n            \n            )\n            +\n            17\n            f\n            (\n            \n              x\n              \n                n\n              \n            \n            )\n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle \\int _{a}^{b}f(x)\\,dx\\approx {\\frac {1}{48}}h\\left[17f(x_{0})+59f(x_{1})+43f(x_{2})+49f(x_{3})+48\\sum _{i=4}^{n-4}f(x_{i})+49f(x_{n-3})+43f(x_{n-2})+59f(x_{n-1})+17f(x_{n})\\right].}\n  \n\nThe formula above is obtained by combining the composite Simpson's 1/3 rule with the one consisting of using Simpson's 3/8 rule in the extreme subintervals and Simpson's 1/3 rule in the remaining subintervals. The result is then obtained by taking the mean of the two formulas.\n\nSimpson's rules in the case of narrow peaks\nIn the task of estimation of full area of narrow peak-like functions, Simpson's rules are much less efficient than trapezoidal rule. Namely, composite Simpson's 1/3 rule requires 1.8 times more points to achieve the same accuracy as trapezoidal rule. Composite Simpson's 3/8 rule is even less accurate. Integration by Simpson's 1/3 rule can be represented as a weighted average with 2/3 of the value coming from integration by the trapezoidal rule with step h and 1/3 of the value coming from integration by the rectangle rule with step 2h. The accuracy is governed by the second (2h step) term. Averaging of Simpson's 1/3 rule composite sums with properly shifted frames produces the following rules:\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            1\n            24\n          \n        \n        h\n        \n          [\n          \n            −\n            f\n            (\n            \n              x\n              \n                −\n                1\n              \n            \n            )\n            +\n            12\n            f\n            (\n            \n              x\n              \n                0\n              \n            \n            )\n            +\n            25\n            f\n            (\n            \n              x\n              \n                1\n              \n            \n            )\n            +\n            24\n            \n              ∑\n              \n                i\n                =\n                2\n              \n              \n                n\n                −\n                2\n              \n            \n            f\n            (\n            \n              x\n              \n                i\n              \n            \n            )\n            +\n            25\n            f\n            (\n            \n              x\n              \n                n\n                −\n                1\n              \n            \n            )\n            +\n            12\n            f\n            (\n            \n              x\n              \n                n\n              \n            \n            )\n            −\n            f\n            (\n            \n              x\n              \n                n\n                +\n                1\n              \n            \n            )\n          \n          ]\n        \n        ,\n      \n    \n    {\\displaystyle \\int _{a}^{b}f(x)\\,dx\\approx {\\frac {1}{24}}h\\left[-f(x_{-1})+12f(x_{0})+25f(x_{1})+24\\sum _{i=2}^{n-2}f(x_{i})+25f(x_{n-1})+12f(x_{n})-f(x_{n+1})\\right],}\n  \n\nwhere two points outside of the integrated region are exploited, and \n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          \n            1\n            24\n          \n        \n        h\n        \n          [\n          \n            9\n            f\n            (\n            \n              x\n              \n                0\n              \n            \n            )\n            +\n            28\n            f\n            (\n            \n              x\n              \n                1\n              \n            \n            )\n            +\n            23\n            f\n            (\n            \n              x\n              \n                2\n              \n            \n            )\n            +\n            24\n            \n              ∑\n              \n                i\n                =\n                3\n              \n              \n                n\n                −\n                3\n              \n            \n            f\n            (\n            \n              x\n              \n                i\n              \n            \n            )\n            +\n            23\n            f\n            (\n            \n              x\n              \n                n\n                −\n                2\n              \n            \n            )\n            +\n            28\n            f\n            (\n            \n              x\n              \n                n\n                −\n                1\n              \n            \n            )\n            +\n            9\n            f\n            (\n            \n              x\n              \n                n\n              \n            \n            )\n          \n          ]\n        \n        ,\n      \n    \n    {\\displaystyle \\int _{a}^{b}f(x)\\,dx\\approx {\\frac {1}{24}}h\\left[9f(x_{0})+28f(x_{1})+23f(x_{2})+24\\sum _{i=3}^{n-3}f(x_{i})+23f(x_{n-2})+28f(x_{n-1})+9f(x_{n})\\right],}\n  \n\nwhere only points within integration region are used. Application of the second rule to the region of 3 points generates 1/3 Simpson's rule, 4 points - 3/8 rule.\nThese rules are very much similar to the alternative extended Simpson's rule. The coefficients within the major part of the region being integrated are one with non-unit coefficients only at the edges. These two rules can be associated with Euler–MacLaurin formula with the first derivative term and named First order Euler–MacLaurin integration rules. The two rules presented above differ only in the way how the first derivative at the region end is calculated. The first derivative term in the Euler–MacLaurin integration rules accounts for integral of the second derivative, which equals the difference of the first derivatives at the edges of the integration region. It is possible to generate higher order Euler–Maclaurin rules by adding a difference of 3rd, 5th, and so on derivatives with coefficients, as defined by Euler–MacLaurin formula.\n\nComposite Simpson's rule for irregularly spaced data\nFor some applications, the integration interval \n  \n    \n      \n        I\n        =\n        [\n        a\n        ,\n        b\n        ]\n      \n    \n    {\\displaystyle I=[a,b]}\n  \n needs to be divided into uneven intervals – perhaps due to uneven sampling of data, or missing or corrupted data points. Suppose we divide the interval \n  \n    \n      \n        I\n      \n    \n    {\\displaystyle I}\n  \n into an even number \n  \n    \n      \n        N\n      \n    \n    {\\displaystyle N}\n  \n of subintervals of widths \n  \n    \n      \n        \n          h\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle h_{k}}\n  \n. Then the composite Simpson's rule is given by\n\n  \n    \n      \n        \n          ∫\n          \n            a\n          \n          \n            b\n          \n        \n        f\n        (\n        x\n        )\n        \n        d\n        x\n        ≈\n        \n          ∑\n          \n            i\n            =\n            0\n          \n          \n            N\n            \n              /\n            \n            2\n            −\n            1\n          \n        \n        \n          \n            \n              \n                h\n                \n                  2\n                  i\n                \n              \n              +\n              \n                h\n                \n                  2\n                  i\n                  +\n                  1\n                \n              \n            \n            6\n          \n        \n        \n          [\n          \n            \n              (\n              \n                2\n                −\n                \n                  \n                    \n                      h\n                      \n                        2\n                        i\n                        +\n                        1\n                      \n                    \n                    \n                      h\n                      \n                        2\n                        i\n                      \n                    \n                  \n                \n              \n              )\n            \n            \n              f\n              \n                2\n                i\n              \n            \n            +\n            \n              \n                \n                  (\n                  \n                    h\n                    \n                      2\n                      i\n                    \n                  \n                  +\n                  \n                    h\n                    \n                      2\n                      i\n                      +\n                      1\n                    \n                  \n                  \n                    )\n                    \n                      2\n                    \n                  \n                \n                \n                  \n                    h\n                    \n                      2\n                      i\n                    \n                  \n                  \n                    h\n                    \n                      2\n                      i\n                      +\n                      1\n                    \n                  \n                \n              \n            \n            \n              f\n              \n                2\n                i\n                +\n                1\n              \n            \n            +\n            \n              (\n              \n                2\n                −\n                \n                  \n                    \n                      h\n                      \n                        2\n                        i\n                      \n                    \n                    \n                      h\n                      \n                        2\n                        i\n                        +\n                        1\n                      \n                    \n                  \n                \n              \n              )\n            \n            \n              f\n              \n                2\n                i\n                +\n                2\n              \n            \n          \n          ]\n        \n        ,\n      \n    \n    {\\displaystyle \\int _{a}^{b}f(x)\\,dx\\approx \\sum _{i=0}^{N/2-1}{\\frac {h_{2i}+h_{2i+1}}{6}}\\left[\\left(2-{\\frac {h_{2i+1}}{h_{2i}}}\\right)f_{2i}+{\\frac {(h_{2i}+h_{2i+1})^{2}}{h_{2i}h_{2i+1}}}f_{2i+1}+\\left(2-{\\frac {h_{2i}}{h_{2i+1}}}\\right)f_{2i+2}\\right],}\n  \n\nwhere\n\n  \n    \n      \n        \n          f\n          \n            k\n          \n        \n        =\n        f\n        \n          (\n          \n            a\n            +\n            \n              ∑\n              \n                i\n                =\n                0\n              \n              \n                k\n                −\n                1\n              \n            \n            \n              h\n              \n                i\n              \n            \n          \n          )\n        \n      \n    \n    {\\displaystyle f_{k}=f\\left(a+\\sum _{i=0}^{k-1}h_{i}\\right)}\n  \n\nare the function values at the \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \nth sampling point on the interval \n  \n    \n      \n        I\n      \n    \n    {\\displaystyle I}\n  \n.\nIn case of an odd number \n  \n    \n      \n        N\n      \n    \n    {\\displaystyle N}\n  \n of subintervals, the above formula is used up to the second to last interval, \nand the last interval is handled separately by adding the following to the result:\n\n  \n    \n      \n        α\n        \n          f\n          \n            N\n          \n        \n        +\n        β\n        \n          f\n          \n            N\n            −\n            1\n          \n        \n        −\n        η\n        \n          f\n          \n            N\n            −\n            2\n          \n        \n        ,\n      \n    \n    {\\displaystyle \\alpha f_{N}+\\beta f_{N-1}-\\eta f_{N-2},}\n  \n\nwhere\n\n  \n    \n      \n        \n          \n            \n              \n                α\n              \n              \n                \n                =\n                \n                  \n                    \n                      2\n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                        \n                          2\n                        \n                      \n                      +\n                      3\n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                    \n                    \n                      6\n                      (\n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                      +\n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      )\n                    \n                  \n                \n                ,\n              \n            \n            \n              \n                β\n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                        \n                          2\n                        \n                      \n                      +\n                      3\n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                    \n                    \n                      6\n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                    \n                  \n                \n                ,\n              \n            \n            \n              \n                η\n              \n              \n                \n                =\n                \n                  \n                    \n                      h\n                      \n                        N\n                        −\n                        1\n                      \n                      \n                        3\n                      \n                    \n                    \n                      6\n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                      (\n                      \n                        h\n                        \n                          N\n                          −\n                          2\n                        \n                      \n                      +\n                      \n                        h\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      )\n                    \n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\alpha &={\\frac {2h_{N-1}^{2}+3h_{N-1}h_{N-2}}{6(h_{N-2}+h_{N-1})}},\\\\[1ex]\\beta &={\\frac {h_{N-1}^{2}+3h_{N-1}h_{N-2}}{6h_{N-2}}},\\\\[1ex]\\eta &={\\frac {h_{N-1}^{3}}{6h_{N-2}(h_{N-2}+h_{N-1})}}.\\end{aligned}}}\n\nSee also\nNewton–Cotes formulas\nGaussian quadrature\n\nNotes\nReferences\nAtkinson, Kendall E. (1989). An Introduction to Numerical Analysis (2nd ed.). John Wiley & Sons. ISBN 0-471-50023-2.\nBurden, Richard L.; Faires, J. Douglas (2000). Numerical Analysis (7th ed.). Brooks/Cole. ISBN 0-534-38216-9.\nCartwright, Kenneth V. (September 2017). \"Simpson's Rule Cumulative Integration with MS Excel and Irregularly-spaced Data\" (PDF). Journal of Mathematical Sciences and Mathematics Education. 12 (2): 1–9. Retrieved 18 December 2022.\nKalambet, Yuri; Kozmin, Yuri; Samokhin, Andrey (2018). \"Comparison of integration rules in the case of very narrow chromatographic peaks\". Chemometrics and Intelligent Laboratory Systems. 179: 22–30. doi:10.1016/j.chemolab.2018.06.001. ISSN 0169-7439.\nMatthews, John H. (2004). \"Simpson's 3/8 Rule for Numerical Integration\". Numerical Analysis - Numerical Methods Project. California State University, Fullerton. Archived from the original on 4 December 2008. Retrieved 11 November 2008.\nShklov, N. (December 1960). \"Simpson's Rule for Unequally Spaced Ordinates\". The American Mathematical Monthly. 67 (10): 1022–1023. doi:10.2307/2309244. JSTOR 2309244.\nSüli, Endre; Mayers, David (2003). An Introduction to Numerical Analysis. Cambridge University Press. ISBN 0-521-00794-1.\nWeisstein, Eric W. \"Newton-Cotes Formulas\". MathWorld. Retrieved 14 December 2022.\n\nExternal links\n\"Simpson formula\". Encyclopedia of Mathematics. EMS Press. 2001 [1994].\nWeisstein, Eric W. \"Simpson's Rule\". MathWorld.\nSimpson's 1/3rd rule of integration — Notes, PPT, Mathcad, Matlab, Mathematica, Maple at Numerical Methods for STEM undergraduate\nA detailed description of a computer implementation is described by Dorai Sitaram in Teach Yourself Scheme in Fixnum Days, Appendix C\n\nThis article incorporates material from Code for Simpson's rule on PlanetMath, which is licensed under the Creative Commons Attribution/Share-Alike License.\n",
  "categories": [
    "Category:Articles containing German-language text",
    "Category:Articles with example Python (programming language) code",
    "Category:Articles with example R code",
    "Category:Articles with short description",
    "Category:Integral calculus",
    "Category:Numerical analysis",
    "Category:Numerical integration (quadrature)",
    "Category:Short description is different from Wikidata",
    "Category:Use dmy dates from January 2020",
    "Category:Wikipedia articles incorporating text from PlanetMath"
  ],
  "archived_date": "20241221_183045",
  "source_url": "https://en.wikipedia.org/wiki/Simpson%27s_rule"
}