{
  "title": "Shamir's secret sharing",
  "summary": "Shamir's secret sharing (SSS) is an efficient secret sharing algorithm for distributing private information (the \"secret\") among a group. The secret cannot be revealed unless a quorum of the group acts together to pool their knowledge. To achieve this, the secret is mathematically divided into parts (the \"shares\") from which the secret can be reassembled only when a sufficient number of shares are combined. SSS has the property of information-theoretic security, meaning that even if an attacker ",
  "content": "---\ntitle: Shamir's secret sharing\nurl: https://en.wikipedia.org/wiki/Shamir%27s_secret_sharing\nlanguage: en\ncategories: [\"Category:Articles with example Python (programming language) code\", \"Category:Articles with short description\", \"Category:CS1: long volume value\", \"Category:Information-theoretically secure algorithms\", \"Category:Secret sharing\", \"Category:Short description is different from Wikidata\"]\nreferences: 0\nlast_modified: 2024-12-19T14:03:16Z\n---\n\n# Shamir's secret sharing\n\n## Summary\n\nShamir's secret sharing (SSS) is an efficient secret sharing algorithm for distributing private information (the \"secret\") among a group. The secret cannot be revealed unless a quorum of the group acts together to pool their knowledge. To achieve this, the secret is mathematically divided into parts (the \"shares\") from which the secret can be reassembled only when a sufficient number of shares are combined. SSS has the property of information-theoretic security, meaning that even if an attacker \n\n## Full Content\n\nShamir's secret sharing (SSS) is an efficient secret sharing algorithm for distributing private information (the \"secret\") among a group. The secret cannot be revealed unless a quorum of the group acts together to pool their knowledge. To achieve this, the secret is mathematically divided into parts (the \"shares\") from which the secret can be reassembled only when a sufficient number of shares are combined. SSS has the property of information-theoretic security, meaning that even if an attacker steals some shares, it is impossible for the attacker to reconstruct the secret unless they have stolen the quorum number of shares.\nShamir's secret sharing is used in some applications to share the access keys to a master secret.\n\nHigh-level explanation\nSSS is used to secure a secret in a distributed form, most often to secure encryption keys. The secret is split into multiple shares, which individually do not give any information about the secret.\nTo reconstruct a secret secured by SSS, a number of shares is needed, called the threshold. No information about the secret can be gained from any number of shares below the threshold (a property called perfect secrecy). In this sense, SSS is a generalisation of the one-time pad (which can be viewed as SSS with a two-share threshold and two shares in total).\n\nApplication example\nA company needs to secure their vault. If a single person knows the code to the vault, the code might be lost or unavailable when the vault needs to be opened. If there are several people who know the code, they may not trust each other to always act honestly.\nSSS can be used in this situation to generate shares of the vault's code which are distributed to authorized individuals in the company. The minimum threshold and number of shares given to each individual can be selected such that the vault is accessible only by (groups of) authorized individuals. If fewer shares than the threshold are presented, the vault cannot be opened.\n\nBy accident, coercion or as an act of opposition, some individuals might present incorrect information for their shares. If the total of correct shares fails to meet the minimum threshold, the vault remains locked.\n\nUse cases\nShamir's secret sharing can be used to\n\nshare a key for decrypting the root key of a password manager,\nrecover a user key for encrypted email access and\nshare the passphrase used to recreate a master secret, which is in turn used to access a cryptocurrency wallet.\n\nProperties and weaknesses\nSSS has useful properties, but also weaknesses that means that it is unsuited to some uses.\nUseful properties include:\n\nSecure: The scheme has information-theoretic security.\nMinimal: The size of each piece does not exceed the size of the original data.\nExtensible: For any given threshold, shares can be dynamically added or deleted without affecting existing shares\nDynamic: Security can be enhanced without changing the secret, but by changing the polynomial occasionally (keeping the same free term) and constructing a new share for each of the participants.\nFlexible: In organizations where hierarchy is important, each participant can be issued different numbers of shares according to their importance inside the organization. For instance, with a threshold of 3, the president could unlock the safe alone if given three shares, while three secretaries with one share each must combine their shares to unlock the safe.\nWeaknesses include:\n\nNo verifiable secret sharing: During the share reassembly process, SSS does not provide a way to verify the correctness of each share being used. Verifiable secret sharing aims to verify that shareholders are honest and not submitting fake shares.\nSingle point of failure: The secret must exist in one place when it is split into shares, and again in one place when it is reassembled. These are attack points, and other schemes including multisignature eliminate at least one of these single points of failure.\n\nHistory\nAdi Shamir, an Israeli scientist, first formulated the scheme in 1979.\n\nMathematical principle\nThe scheme exploits the Lagrange interpolation theorem, specifically that \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n points on the polynomial uniquely determines a polynomial of degree less than or equal to \n  \n    \n      \n        k\n        −\n        1\n      \n    \n    {\\displaystyle k-1}\n  \n. For instance, 2 points are sufficient to define a line, 3 points are sufficient to define a parabola, 4 points to define a cubic curve and so forth.\n\nMathematical formulation\nShamir's secret sharing is an ideal and perfect \n  \n    \n      \n        \n          (\n          \n            k\n            ,\n            n\n          \n          )\n        \n      \n    \n    {\\displaystyle \\left(k,n\\right)}\n  \n-threshold scheme based on polynomial interpolation over finite fields. In such a scheme, the aim is to divide a secret \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n (for example, the combination to a safe) into \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n pieces of data \n  \n    \n      \n        \n          S\n          \n            1\n          \n        \n        ,\n        …\n        ,\n        \n          S\n          \n            n\n          \n        \n      \n    \n    {\\displaystyle S_{1},\\ldots ,S_{n}}\n  \n (known as shares) in such a way that:\n\nKnowledge of any \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n or more shares \n  \n    \n      \n        \n          S\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle S_{i}}\n  \n makes \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n computable. That is, the entire secret \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n can be reconstructed from any combination of \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n shares.\nKnowledge of any \n  \n    \n      \n        k\n        −\n        1\n      \n    \n    {\\displaystyle k-1}\n  \n or fewer shares \n  \n    \n      \n        \n          S\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle S_{i}}\n  \n leaves \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n completely undetermined, in the sense that the possible values for \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n remain as likely with knowledge of up to \n  \n    \n      \n        k\n        −\n        1\n      \n    \n    {\\displaystyle k-1}\n  \n shares as with knowledge of \n  \n    \n      \n        0\n      \n    \n    {\\displaystyle 0}\n  \n shares. The secret \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n cannot be reconstructed with fewer than \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n shares.\nIf \n  \n    \n      \n        n\n        =\n        k\n      \n    \n    {\\displaystyle n=k}\n  \n, then all of the shares are needed to reconstruct the secret \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n.\nAssume that the secret \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n can be represented as an element \n  \n    \n      \n        \n          a\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle a_{0}}\n  \n of a finite field \n  \n    \n      \n        \n          G\n          F\n        \n        (\n        q\n        )\n      \n    \n    {\\displaystyle \\mathrm {GF} (q)}\n  \n (where \n  \n    \n      \n        q\n      \n    \n    {\\displaystyle q}\n  \n is greater than the number \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n of shares being generated). Randomly choose \n  \n    \n      \n        k\n        −\n        1\n      \n    \n    {\\displaystyle k-1}\n  \n elements, \n  \n    \n      \n        \n          a\n          \n            1\n          \n        \n        ,\n        ⋯\n        ,\n        \n          a\n          \n            k\n            −\n            1\n          \n        \n      \n    \n    {\\displaystyle a_{1},\\cdots ,a_{k-1}}\n  \n, from \n  \n    \n      \n        \n          G\n          F\n        \n        (\n        q\n        )\n      \n    \n    {\\displaystyle \\mathrm {GF} (q)}\n  \n and construct the polynomial \n  \n    \n      \n        f\n        \n          (\n          x\n          )\n        \n        =\n        \n          a\n          \n            0\n          \n        \n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n        +\n        \n          a\n          \n            3\n          \n        \n        \n          x\n          \n            3\n          \n        \n        +\n        ⋯\n        +\n        \n          a\n          \n            k\n            −\n            1\n          \n        \n        \n          x\n          \n            k\n            −\n            1\n          \n        \n      \n    \n    {\\displaystyle f\\left(x\\right)=a_{0}+a_{1}x+a_{2}x^{2}+a_{3}x^{3}+\\cdots +a_{k-1}x^{k-1}}\n  \n. Compute any \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n points out on the curve, for instance set \n  \n    \n      \n        i\n        =\n        1\n        ,\n        …\n        ,\n        n\n      \n    \n    {\\displaystyle i=1,\\ldots ,n}\n  \n to find points \n  \n    \n      \n        \n          (\n          \n            i\n            ,\n            f\n            \n              (\n              i\n              )\n            \n          \n          )\n        \n      \n    \n    {\\displaystyle \\left(i,f\\left(i\\right)\\right)}\n  \n. Every participant is given a point (a non-zero input to the polynomial, and the corresponding output). Given any subset of \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n of these pairs, \n  \n    \n      \n        \n          a\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle a_{0}}\n  \n can be obtained using interpolation, with one possible formula for doing so being \n  \n    \n      \n        \n          a\n          \n            0\n          \n        \n        =\n        f\n        (\n        0\n        )\n        =\n        \n          ∑\n          \n            j\n            =\n            0\n          \n          \n            k\n            −\n            1\n          \n        \n        \n          y\n          \n            j\n          \n        \n        \n          ∏\n          \n            \n              \n                \n                  \n                    m\n                    \n                    =\n                    \n                    0\n                  \n                \n                \n                  \n                    m\n                    \n                    ≠\n                    \n                    j\n                  \n                \n              \n            \n          \n          \n            k\n            −\n            1\n          \n        \n        \n          \n            \n              x\n              \n                m\n              \n            \n            \n              \n                x\n                \n                  m\n                \n              \n              −\n              \n                x\n                \n                  j\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle a_{0}=f(0)=\\sum _{j=0}^{k-1}y_{j}\\prod _{\\begin{smallmatrix}m\\,=\\,0\\\\m\\,\\neq \\,j\\end{smallmatrix}}^{k-1}{\\frac {x_{m}}{x_{m}-x_{j}}}}\n  \n, where the list of points on the polynomial is given as \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n pairs of the form \n  \n    \n      \n        (\n        \n          x\n          \n            i\n          \n        \n        ,\n        \n          y\n          \n            i\n          \n        \n        )\n      \n    \n    {\\displaystyle (x_{i},y_{i})}\n  \n. Note that \n  \n    \n      \n        f\n        (\n        0\n        )\n      \n    \n    {\\displaystyle f(0)}\n  \n is equal to the first coefficient of polynomial \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n.\n\nExample calculation\nThe following example illustrates the basic idea. Note, however, that calculations in the example are done using integer arithmetic rather than using finite field arithmetic to make the idea easier to understand. Therefore, the example below does not provide perfect secrecy and is not a proper example of Shamir's scheme. The next example will explain the problem.\n\nPreparation\nSuppose that the secret to be shared is 1234 \n  \n    \n      \n        (\n        S\n        =\n        1234\n        )\n      \n    \n    {\\displaystyle (S=1234)}\n  \n.\nIn this example, the secret will be split into 6 shares \n  \n    \n      \n        (\n        n\n        =\n        6\n        )\n      \n    \n    {\\displaystyle (n=6)}\n  \n, where any subset of 3 shares \n  \n    \n      \n        (\n        k\n        =\n        3\n        )\n      \n    \n    {\\displaystyle (k=3)}\n  \n is sufficient to reconstruct the secret. \n  \n    \n      \n        k\n        −\n        1\n        =\n        2\n      \n    \n    {\\displaystyle k-1=2}\n  \n numbers are taken at random. Let them be 166 and 94.\n\nThis yields coefficients \n  \n    \n      \n        (\n        \n          a\n          \n            0\n          \n        \n        =\n        1234\n        ;\n        \n          a\n          \n            1\n          \n        \n        =\n        166\n        ;\n        \n          a\n          \n            2\n          \n        \n        =\n        94\n        )\n        ,\n      \n    \n    {\\displaystyle (a_{0}=1234;a_{1}=166;a_{2}=94),}\n  \n where \n  \n    \n      \n        \n          a\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle a_{0}}\n  \n is the secret\nThe polynomial to produce secret shares (points) is therefore:\n\n  \n    \n      \n        f\n        (\n        x\n        )\n        =\n        1234\n        +\n        166\n        x\n        +\n        94\n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle f(x)=1234+166x+94x^{2}}\n  \n\nSix points \n  \n    \n      \n        \n          D\n          \n            x\n            −\n            1\n          \n        \n        =\n        (\n        x\n        ,\n        f\n        (\n        x\n        )\n        )\n      \n    \n    {\\displaystyle D_{x-1}=(x,f(x))}\n  \n from the polynomial are constructed as:\n\n  \n    \n      \n        \n          D\n          \n            0\n          \n        \n        =\n        (\n        1\n        ,\n        1494\n        )\n        ;\n        \n          D\n          \n            1\n          \n        \n        =\n        (\n        2\n        ,\n        1942\n        )\n        ;\n        \n          D\n          \n            2\n          \n        \n        =\n        (\n        3\n        ,\n        2578\n        )\n        ;\n        \n          D\n          \n            3\n          \n        \n        =\n        (\n        4\n        ,\n        3402\n        )\n        ;\n        \n          D\n          \n            4\n          \n        \n        =\n        (\n        5\n        ,\n        4414\n        )\n        ;\n        \n          D\n          \n            5\n          \n        \n        =\n        (\n        6\n        ,\n        5614\n        )\n      \n    \n    {\\displaystyle D_{0}=(1,1494);D_{1}=(2,1942);D_{2}=(3,2578);D_{3}=(4,3402);D_{4}=(5,4414);D_{5}=(6,5614)}\n  \n\nEach participant in the scheme receives a different point (a pair of \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n and \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n). Because \n  \n    \n      \n        \n          D\n          \n            x\n            −\n            1\n          \n        \n      \n    \n    {\\displaystyle D_{x-1}}\n  \n is used instead of \n  \n    \n      \n        \n          D\n          \n            x\n          \n        \n      \n    \n    {\\displaystyle D_{x}}\n  \n the points start from \n  \n    \n      \n        (\n        1\n        ,\n        f\n        (\n        1\n        )\n        )\n      \n    \n    {\\displaystyle (1,f(1))}\n  \n and not \n  \n    \n      \n        (\n        0\n        ,\n        f\n        (\n        0\n        )\n        )\n      \n    \n    {\\displaystyle (0,f(0))}\n  \n. This is necessary because \n  \n    \n      \n        f\n        (\n        0\n        )\n      \n    \n    {\\displaystyle f(0)}\n  \n is the secret.\n\nReconstruction\nIn order to reconstruct the secret, any 3 points are sufficient\nConsider using the 3 points\n  \n    \n      \n        \n          (\n          \n            \n              x\n              \n                0\n              \n            \n            ,\n            \n              y\n              \n                0\n              \n            \n          \n          )\n        \n        =\n        \n          (\n          \n            2\n            ,\n            1942\n          \n          )\n        \n        ;\n        \n          (\n          \n            \n              x\n              \n                1\n              \n            \n            ,\n            \n              y\n              \n                1\n              \n            \n          \n          )\n        \n        =\n        \n          (\n          \n            4\n            ,\n            3402\n          \n          )\n        \n        ;\n        \n          (\n          \n            \n              x\n              \n                2\n              \n            \n            ,\n            \n              y\n              \n                2\n              \n            \n          \n          )\n        \n        =\n        \n          (\n          \n            5\n            ,\n            4414\n          \n          )\n        \n      \n    \n    {\\displaystyle \\left(x_{0},y_{0}\\right)=\\left(2,1942\\right);\\left(x_{1},y_{1}\\right)=\\left(4,3402\\right);\\left(x_{2},y_{2}\\right)=\\left(5,4414\\right)}\n  \n.\nComputing the Lagrange basis polynomials:\n\n  \n    \n      \n        \n          ℓ\n          \n            0\n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  1\n                \n              \n            \n            \n              \n                x\n                \n                  0\n                \n              \n              −\n              \n                x\n                \n                  1\n                \n              \n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  2\n                \n              \n            \n            \n              \n                x\n                \n                  0\n                \n              \n              −\n              \n                x\n                \n                  2\n                \n              \n            \n          \n        \n        =\n        \n          \n            \n              x\n              −\n              4\n            \n            \n              2\n              −\n              4\n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              5\n            \n            \n              2\n              −\n              5\n            \n          \n        \n        =\n        \n          \n            1\n            6\n          \n        \n        \n          x\n          \n            2\n          \n        \n        −\n        \n          \n            3\n            2\n          \n        \n        x\n        +\n        \n          \n            10\n            3\n          \n        \n      \n    \n    {\\displaystyle \\ell _{0}(x)={\\frac {x-x_{1}}{x_{0}-x_{1}}}\\cdot {\\frac {x-x_{2}}{x_{0}-x_{2}}}={\\frac {x-4}{2-4}}\\cdot {\\frac {x-5}{2-5}}={\\frac {1}{6}}x^{2}-{\\frac {3}{2}}x+{\\frac {10}{3}}}\n  \n\n  \n    \n      \n        \n          ℓ\n          \n            1\n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  0\n                \n              \n            \n            \n              \n                x\n                \n                  1\n                \n              \n              −\n              \n                x\n                \n                  0\n                \n              \n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  2\n                \n              \n            \n            \n              \n                x\n                \n                  1\n                \n              \n              −\n              \n                x\n                \n                  2\n                \n              \n            \n          \n        \n        =\n        \n          \n            \n              x\n              −\n              2\n            \n            \n              4\n              −\n              2\n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              5\n            \n            \n              4\n              −\n              5\n            \n          \n        \n        =\n        −\n        \n          \n            1\n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n        +\n        \n          \n            7\n            2\n          \n        \n        x\n        −\n        5\n      \n    \n    {\\displaystyle \\ell _{1}(x)={\\frac {x-x_{0}}{x_{1}-x_{0}}}\\cdot {\\frac {x-x_{2}}{x_{1}-x_{2}}}={\\frac {x-2}{4-2}}\\cdot {\\frac {x-5}{4-5}}=-{\\frac {1}{2}}x^{2}+{\\frac {7}{2}}x-5}\n  \n\n  \n    \n      \n        \n          ℓ\n          \n            2\n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  0\n                \n              \n            \n            \n              \n                x\n                \n                  2\n                \n              \n              −\n              \n                x\n                \n                  0\n                \n              \n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              \n                x\n                \n                  1\n                \n              \n            \n            \n              \n                x\n                \n                  2\n                \n              \n              −\n              \n                x\n                \n                  1\n                \n              \n            \n          \n        \n        =\n        \n          \n            \n              x\n              −\n              2\n            \n            \n              5\n              −\n              2\n            \n          \n        \n        ⋅\n        \n          \n            \n              x\n              −\n              4\n            \n            \n              5\n              −\n              4\n            \n          \n        \n        =\n        \n          \n            1\n            3\n          \n        \n        \n          x\n          \n            2\n          \n        \n        −\n        2\n        x\n        +\n        \n          \n            8\n            3\n          \n        \n      \n    \n    {\\displaystyle \\ell _{2}(x)={\\frac {x-x_{0}}{x_{2}-x_{0}}}\\cdot {\\frac {x-x_{1}}{x_{2}-x_{1}}}={\\frac {x-2}{5-2}}\\cdot {\\frac {x-4}{5-4}}={\\frac {1}{3}}x^{2}-2x+{\\frac {8}{3}}}\n  \n\nUsing the formula for polynomial interpolation, \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n is:\n\n  \n    \n      \n        \n          \n            \n              \n                f\n                (\n                x\n                )\n              \n              \n                \n                =\n                \n                  ∑\n                  \n                    j\n                    =\n                    0\n                  \n                  \n                    2\n                  \n                \n                \n                  y\n                  \n                    j\n                  \n                \n                ⋅\n                \n                  ℓ\n                  \n                    j\n                  \n                \n                (\n                x\n                )\n              \n            \n            \n              \n              \n                \n                =\n                \n                  y\n                  \n                    0\n                  \n                \n                \n                  ℓ\n                  \n                    0\n                  \n                \n                (\n                x\n                )\n                +\n                \n                  y\n                  \n                    1\n                  \n                \n                \n                  ℓ\n                  \n                    1\n                  \n                \n                (\n                x\n                )\n                +\n                \n                  y\n                  \n                    2\n                  \n                \n                \n                  ℓ\n                  \n                    2\n                  \n                \n                (\n                x\n                )\n              \n            \n            \n              \n              \n                \n                =\n                1942\n                \n                  (\n                  \n                    \n                      \n                        1\n                        6\n                      \n                    \n                    \n                      x\n                      \n                        2\n                      \n                    \n                    −\n                    \n                      \n                        3\n                        2\n                      \n                    \n                    x\n                    +\n                    \n                      \n                        10\n                        3\n                      \n                    \n                  \n                  )\n                \n                +\n                3402\n                \n                  (\n                  \n                    −\n                    \n                      \n                        1\n                        2\n                      \n                    \n                    \n                      x\n                      \n                        2\n                      \n                    \n                    +\n                    \n                      \n                        7\n                        2\n                      \n                    \n                    x\n                    −\n                    5\n                  \n                  )\n                \n                +\n                4414\n                \n                  (\n                  \n                    \n                      \n                        1\n                        3\n                      \n                    \n                    \n                      x\n                      \n                        2\n                      \n                    \n                    −\n                    2\n                    x\n                    +\n                    \n                      \n                        8\n                        3\n                      \n                    \n                  \n                  )\n                \n              \n            \n            \n              \n              \n                \n                =\n                1234\n                +\n                166\n                x\n                +\n                94\n                \n                  x\n                  \n                    2\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}f(x)&=\\sum _{j=0}^{2}y_{j}\\cdot \\ell _{j}(x)\\\\[6pt]&=y_{0}\\ell _{0}(x)+y_{1}\\ell _{1}(x)+y_{2}\\ell _{2}(x)\\\\[6pt]&=1942\\left({\\frac {1}{6}}x^{2}-{\\frac {3}{2}}x+{\\frac {10}{3}}\\right)+3402\\left(-{\\frac {1}{2}}x^{2}+{\\frac {7}{2}}x-5\\right)+4414\\left({\\frac {1}{3}}x^{2}-2x+{\\frac {8}{3}}\\right)\\\\[6pt]&=1234+166x+94x^{2}\\end{aligned}}}\n  \n\nRecalling that the secret is the free coefficient, which means that \n  \n    \n      \n        S\n        =\n        1234\n      \n    \n    {\\displaystyle S=1234}\n  \n, and the secret has been recovered.\n\nComputationally efficient approach\nUsing polynomial interpolation to find a coefficient in a source polynomial \n  \n    \n      \n        S\n        =\n        f\n        (\n        0\n        )\n      \n    \n    {\\displaystyle S=f(0)}\n  \n using Lagrange polynomials is not efficient, since unused constants are calculated.\nConsidering this, an optimized formula to use Lagrange polynomials to find \n  \n    \n      \n        f\n        (\n        0\n        )\n      \n    \n    {\\displaystyle f(0)}\n  \n is defined as follows:\n\n  \n    \n      \n        f\n        (\n        0\n        )\n        =\n        \n          ∑\n          \n            j\n            =\n            0\n          \n          \n            k\n            −\n            1\n          \n        \n        \n          y\n          \n            j\n          \n        \n        \n          ∏\n          \n            \n              \n                \n                  \n                    m\n                    \n                    =\n                    \n                    0\n                  \n                \n                \n                  \n                    m\n                    \n                    ≠\n                    \n                    j\n                  \n                \n              \n            \n          \n          \n            k\n            −\n            1\n          \n        \n        \n          \n            \n              x\n              \n                m\n              \n            \n            \n              \n                x\n                \n                  m\n                \n              \n              −\n              \n                x\n                \n                  j\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle f(0)=\\sum _{j=0}^{k-1}y_{j}\\prod _{\\begin{smallmatrix}m\\,=\\,0\\\\m\\,\\neq \\,j\\end{smallmatrix}}^{k-1}{\\frac {x_{m}}{x_{m}-x_{j}}}}\n\nProblem of using integer arithmetic\nAlthough the simplified version of the method demonstrated above, which uses integer arithmetic rather than finite field arithmetic, works, there is a security problem: Eve gains information about \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n with every \n  \n    \n      \n        \n          D\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle D_{i}}\n  \n that she finds.\nSuppose that she finds the 2 points \n  \n    \n      \n        \n          D\n          \n            0\n          \n        \n        =\n        (\n        1\n        ,\n        1494\n        )\n      \n    \n    {\\displaystyle D_{0}=(1,1494)}\n  \n and \n  \n    \n      \n        \n          D\n          \n            1\n          \n        \n        =\n        (\n        2\n        ,\n        1942\n        )\n      \n    \n    {\\displaystyle D_{1}=(2,1942)}\n  \n. She still does not have \n  \n    \n      \n        k\n        =\n        3\n      \n    \n    {\\displaystyle k=3}\n  \n points, so in theory she should not have gained any more information about \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n. But she  could combine the information from the 2 points with the public information: \n  \n    \n      \n        n\n        =\n        6\n        ,\n        k\n        =\n        3\n        ,\n        f\n        (\n        x\n        )\n        =\n        \n          a\n          \n            0\n          \n        \n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        ⋯\n        +\n        \n          a\n          \n            k\n            −\n            1\n          \n        \n        \n          x\n          \n            k\n            −\n            1\n          \n        \n        ,\n        \n          a\n          \n            0\n          \n        \n        =\n        S\n        ,\n        \n          a\n          \n            i\n          \n        \n        ∈\n        \n          Z\n        \n      \n    \n    {\\displaystyle n=6,k=3,f(x)=a_{0}+a_{1}x+\\cdots +a_{k-1}x^{k-1},a_{0}=S,a_{i}\\in \\mathbb {Z} }\n  \n. Doing so, Eve could perform the following algebra:\n\nFill the formula for \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n with \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n and the value of \n  \n    \n      \n        k\n        :\n        f\n        (\n        x\n        )\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        ⋯\n        +\n        \n          a\n          \n            k\n            −\n            1\n          \n        \n        \n          x\n          \n            k\n            −\n            1\n          \n        \n        ⇒\n        \n\n        \n        f\n        (\n        x\n        )\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle k:f(x)=S+a_{1}x+\\cdots +a_{k-1}x^{k-1}\\Rightarrow {}f(x)=S+a_{1}x+a_{2}x^{2}}\n  \n\nFill (1) with the values of \n  \n    \n      \n        \n          D\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle D_{0}}\n  \n's \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n and \n  \n    \n      \n        f\n        (\n        x\n        )\n        :\n        1494\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        1\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          1\n          \n            2\n          \n        \n        ⇒\n        \n\n        \n        1494\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        +\n        \n          a\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle f(x):1494=S+a_{1}1+a_{2}1^{2}\\Rightarrow {}1494=S+a_{1}+a_{2}}\n  \n\nFill  (1) with the values of \n  \n    \n      \n        \n          D\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle D_{1}}\n  \n's \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n and \n  \n    \n      \n        f\n        (\n        x\n        )\n        :\n        1942\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        2\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          2\n          \n            2\n          \n        \n        ⇒\n        \n\n        \n        1942\n        =\n        S\n        +\n        2\n        \n          a\n          \n            1\n          \n        \n        +\n        4\n        \n          a\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle f(x):1942=S+a_{1}2+a_{2}2^{2}\\Rightarrow {}1942=S+2a_{1}+4a_{2}}\n  \n\nSubtract (3)-(2): \n  \n    \n      \n        (\n        1942\n        −\n        1494\n        )\n        =\n        (\n        S\n        −\n        S\n        )\n        +\n        (\n        2\n        \n          a\n          \n            1\n          \n        \n        −\n        \n          a\n          \n            1\n          \n        \n        )\n        +\n        (\n        4\n        \n          a\n          \n            2\n          \n        \n        −\n        \n          a\n          \n            2\n          \n        \n        )\n        ⇒\n        \n\n        \n        448\n        =\n        \n          a\n          \n            1\n          \n        \n        +\n        3\n        \n          a\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle (1942-1494)=(S-S)+(2a_{1}-a_{1})+(4a_{2}-a_{2})\\Rightarrow {}448=a_{1}+3a_{2}}\n  \n and rewrite this as \n  \n    \n      \n        \n          a\n          \n            1\n          \n        \n        =\n        448\n        −\n        3\n        \n          a\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle a_{1}=448-3a_{2}}\n  \n.\nNow, Eve can replace the result from (4) into (2): \n  \n    \n      \n        1494\n        =\n        S\n        +\n        (\n        448\n        −\n        3\n        \n          a\n          \n            2\n          \n        \n        )\n        +\n        \n          a\n          \n            2\n          \n        \n        ⇒\n        \n\n        \n        S\n        =\n        1046\n        +\n        2\n        \n          a\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle 1494=S+(448-3a_{2})+a_{2}\\Rightarrow {}S=1046+2a_{2}}\n  \n which leads her to the information that S is even.\n\nSolution using finite field arithmetic\nThe above attack exploits constraints on the values that the polynomial may take by virtue of how it was constructed: the polynomial must have coefficients that are integers, and the polynomial must take an integer as value when evaluated at each of the coordinates used in the scheme. This reduces its possible values at unknown points, including the resultant secret, given fewer than \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n shares.\nThis problem can be remedied by using finite field arithmetic.  A finite field always has size \n  \n    \n      \n        q\n        =\n        \n          p\n          \n            r\n          \n        \n      \n    \n    {\\displaystyle q=p^{r}}\n  \n, where \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n is a prime and \n  \n    \n      \n        r\n      \n    \n    {\\displaystyle r}\n  \n is a positive integer.  The size \n  \n    \n      \n        q\n      \n    \n    {\\displaystyle q}\n  \n of the field must satisfy \n  \n    \n      \n        q\n        >\n        n\n      \n    \n    {\\displaystyle q>n}\n  \n, and that \n  \n    \n      \n        q\n      \n    \n    {\\displaystyle q}\n  \n is greater than the number of possible values for the secret, though the latter condition may be circumvented by splitting the secret into smaller secret values, and applying the scheme to each of these.  In our example below, we use a prime field (i.e. r = 1). The figure shows a polynomial curve over a finite field.\nIn practice this is only a small change. The order q of the field (i.e. the number of values that it has) must be chosen to be greater than the number of participants and the number of values that the secret \n  \n    \n      \n        \n          a\n          \n            0\n          \n        \n        =\n        S\n      \n    \n    {\\displaystyle a_{0}=S}\n  \n may take. All calculations involving the polynomial must also be calculated over the field (mod p in our example, in which \n  \n    \n      \n        p\n        =\n        q\n      \n    \n    {\\displaystyle p=q}\n  \n is taken to be a prime) instead of over the integers.  Both the choice of the field and the mapping of the secret to a value in this field are considered to be publicly known.\nFor this example, choose \n  \n    \n      \n        p\n        =\n        1613\n      \n    \n    {\\displaystyle p=1613}\n  \n, so the polynomial becomes \n  \n    \n      \n        f\n        (\n        x\n        )\n        =\n        1234\n        +\n        166\n        x\n        +\n        94\n        \n          x\n          \n            2\n          \n        \n        \n          mod\n          \n            1613\n          \n        \n      \n    \n    {\\displaystyle f(x)=1234+166x+94x^{2}{\\bmod {1613}}}\n  \n which gives the points: \n  \n    \n      \n        (\n        1\n        ,\n        1494\n        )\n        ;\n        (\n        2\n        ,\n        329\n        )\n        ;\n        (\n        3\n        ,\n        965\n        )\n        ;\n        (\n        4\n        ,\n        176\n        )\n        ;\n        (\n        5\n        ,\n        1188\n        )\n        ;\n        (\n        6\n        ,\n        775\n        )\n      \n    \n    {\\displaystyle (1,1494);(2,329);(3,965);(4,176);(5,1188);(6,775)}\n  \n\nThis time Eve doesn't gain any information when she finds a \n  \n    \n      \n        \n          D\n          \n            x\n          \n        \n      \n    \n    {\\displaystyle D_{x}}\n  \n (until she has \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n points).\nSuppose again that Eve finds \n  \n    \n      \n        \n          D\n          \n            0\n          \n        \n        =\n        \n          (\n          \n            1\n            ,\n            1494\n          \n          )\n        \n      \n    \n    {\\displaystyle D_{0}=\\left(1,1494\\right)}\n  \n and \n  \n    \n      \n        \n          D\n          \n            1\n          \n        \n        =\n        \n          (\n          \n            2\n            ,\n            329\n          \n          )\n        \n      \n    \n    {\\displaystyle D_{1}=\\left(2,329\\right)}\n  \n, and the public information is: \n  \n    \n      \n        n\n        =\n        6\n        ,\n        k\n        =\n        3\n        ,\n        p\n        =\n        1613\n        ,\n        f\n        (\n        x\n        )\n        =\n        \n          a\n          \n            0\n          \n        \n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        ⋯\n        +\n        \n          a\n          \n            k\n            −\n            1\n          \n        \n        \n          x\n          \n            k\n            −\n            1\n          \n        \n        \n        mod\n        \n        \n        p\n        ,\n        \n          a\n          \n            0\n          \n        \n        =\n        S\n        ,\n        \n          a\n          \n            i\n          \n        \n        ∈\n        \n          N\n        \n      \n    \n    {\\displaystyle n=6,k=3,p=1613,f(x)=a_{0}+a_{1}x+\\dots +a_{k-1}x^{k-1}\\mod {p},a_{0}=S,a_{i}\\in \\mathbb {N} }\n  \n. Attempting the previous attack, Eve can:\n\nFill the \n  \n    \n      \n        f\n        (\n        x\n        )\n      \n    \n    {\\displaystyle f(x)}\n  \n-formula with \n  \n    \n      \n        S\n      \n    \n    {\\displaystyle S}\n  \n and the value of \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n and \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n: \n  \n    \n      \n        f\n        (\n        x\n        )\n        =\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        x\n        +\n        ⋯\n        +\n        \n          a\n          \n            3\n            −\n            1\n          \n        \n        \n          x\n          \n            3\n            −\n            1\n          \n        \n        \n        mod\n        \n        \n        1613\n      \n    \n    {\\displaystyle f(x)=S+a_{1}x+\\dots +a_{3-1}x^{3-1}\\mod 1613}\n  \n\nFill (1) with the values of \n  \n    \n      \n        \n          D\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle D_{0}}\n  \n's \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n and \n  \n    \n      \n        f\n        (\n        x\n        )\n        :\n        1494\n        ≡\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        1\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          1\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n        ⇒\n        \n\n        \n        1494\n        ≡\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        +\n        \n          a\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n      \n    \n    {\\displaystyle f(x):1494\\equiv S+a_{1}1+a_{2}1^{2}{\\pmod {1613}}\\Rightarrow {}1494\\equiv S+a_{1}+a_{2}{\\pmod {1613}}}\n  \n\nFill (1) with the values of \n  \n    \n      \n        \n          D\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle D_{1}}\n  \n's \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n and \n  \n    \n      \n        f\n        (\n        x\n        )\n        :\n        1942\n        ≡\n        S\n        +\n        \n          a\n          \n            1\n          \n        \n        2\n        +\n        \n          a\n          \n            2\n          \n        \n        \n          2\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n        ⇒\n        \n\n        \n        1942\n        ≡\n        S\n        +\n        2\n        \n          a\n          \n            1\n          \n        \n        +\n        4\n        \n          a\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n      \n    \n    {\\displaystyle f(x):1942\\equiv S+a_{1}2+a_{2}2^{2}{\\pmod {1613}}\\Rightarrow {}1942\\equiv S+2a_{1}+4a_{2}{\\pmod {1613}}}\n  \n\nSubtract (3)-(2): \n  \n    \n      \n        (\n        1942\n        −\n        1494\n        )\n        ≡\n        (\n        S\n        −\n        S\n        )\n        +\n        (\n        2\n        \n          a\n          \n            1\n          \n        \n        −\n        \n          a\n          \n            1\n          \n        \n        )\n        +\n        (\n        4\n        \n          a\n          \n            2\n          \n        \n        −\n        \n          a\n          \n            2\n          \n        \n        )\n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n        ⇒\n        \n\n        \n        448\n        ≡\n        \n          a\n          \n            1\n          \n        \n        +\n        3\n        \n          a\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n      \n    \n    {\\displaystyle (1942-1494)\\equiv (S-S)+(2a_{1}-a_{1})+(4a_{2}-a_{2}){\\pmod {1613}}\\Rightarrow {}448\\equiv a_{1}+3a_{2}{\\pmod {1613}}}\n  \n and rewrite this as \n  \n    \n      \n        \n          a\n          \n            1\n          \n        \n        ≡\n        448\n        −\n        3\n        \n          a\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n      \n    \n    {\\displaystyle a_{1}\\equiv 448-3a_{2}{\\pmod {1613}}}\n  \n\nThere are \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n possible values for \n  \n    \n      \n        \n          a\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle a_{1}}\n  \n. She knows that \n  \n    \n      \n        [\n        448\n        ,\n        445\n        ,\n        442\n        ,\n        …\n        ]\n      \n    \n    {\\displaystyle [448,445,442,\\ldots ]}\n  \n always decreases by 3, so if \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n were divisible by \n  \n    \n      \n        3\n      \n    \n    {\\displaystyle 3}\n  \n she could conclude \n  \n    \n      \n        \n          a\n          \n            1\n          \n        \n        ∈\n        [\n        1\n        ,\n        4\n        ,\n        7\n        ,\n        …\n        ]\n      \n    \n    {\\displaystyle a_{1}\\in [1,4,7,\\ldots ]}\n  \n. However, \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n is prime, so she can not conclude this. Thus, using a finite field avoids this possible attack.\nAlso, even though Eve can conclude that \n  \n    \n      \n        S\n        ≡\n        1046\n        +\n        2\n        \n          a\n          \n            2\n          \n        \n        \n          \n          (\n          mod\n          \n          1613\n          )\n        \n      \n    \n    {\\displaystyle S\\equiv 1046+2a_{2}{\\pmod {1613}}}\n  \n, it does not provide any additional information, since the \"wrapping around\" behavior of modular arithmetic prevents the leakage of \"S is even\", unlike the example with integer arithmetic above.\n\nPython code\nFor purposes of keeping the code clearer, a prime field is used here. In practice, for convenience a scheme constructed using a smaller binary field may be separately applied to small substrings of bits of the secret (e.g. GF(256) for byte-wise application), without loss of security.  The strict condition that the size of the field must be larger than the number of shares must still be respected (e.g., if the number of shares could exceed 255, the field GF(256) might be replaced by say GF(65536)).\n\nSee also\nSecret sharing\nSecure multi-party computation\nLagrange polynomial\nHomomorphic secret sharing – a simplistic decentralized voting protocol\nTwo-person rule\nPartial Password\n\nReferences\nFurther reading\nDawson, E.; Donovan, D. (1994), \"The breadth of Shamir's secret-sharing scheme\", Computers & Security, 13: 69–78, doi:10.1016/0167-4048(94)90097-3.\nBenzekki, K. (2017). \"A Verifiable Secret Sharing Approach for Secure MultiCloud Storage\". Ubiquitous Networking. Lecture Notes in Computer Science. Vol. 10542. Casablanca: Springer. pp. 225–234. doi:10.1007/978-3-319-68179-5_20. ISBN 978-3-319-68178-8..\n\nExternal links\nShamir's Secret Sharing in the Crypto++ library\nShamir's Secret Sharing Scheme (ssss) – a GNU GPL implementation\nsharedsecret – implementation in Go\ns4 - online shamir's secret sharing tool utilizing HashiCorp's shamir secret sharing algorithm\nShamir39 - webversion on iancoleman.io\nkn Secrets - webversion on a dedicated website, aiming to make Shamir's secret sharing as accessible as possible\n",
  "categories": [
    "Category:Articles with example Python (programming language) code",
    "Category:Articles with short description",
    "Category:CS1: long volume value",
    "Category:Information-theoretically secure algorithms",
    "Category:Secret sharing",
    "Category:Short description is different from Wikidata"
  ],
  "archived_date": "20241221_183048",
  "source_url": "https://en.wikipedia.org/wiki/Shamir%27s_secret_sharing"
}