{
  "title": "Algorithms for calculating variance",
  "summary": "Algorithms for calculating variance play a major role in computational statistics. A key difficulty in the design of good algorithms for this problem is that formulas for the variance may involve sums of squares, which can lead to numerical instability as well as to arithmetic overflow when dealing with large values.",
  "content": "---\ntitle: Algorithms for calculating variance\nurl: https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance\nlanguage: en\ncategories: [\"Category:All articles with unsourced statements\", \"Category:Articles with example Python (programming language) code\", \"Category:Articles with example pseudocode\", \"Category:Articles with short description\", \"Category:Articles with unsourced statements from March 2023\", \"Category:Short description matches Wikidata\", \"Category:Statistical algorithms\", \"Category:Statistical deviation and dispersion\", \"Category:Use dmy dates from July 2020\"]\nreferences: 0\nlast_modified: 2024-12-19T13:42:01Z\n---\n\n# Algorithms for calculating variance\n\n## Summary\n\nAlgorithms for calculating variance play a major role in computational statistics. A key difficulty in the design of good algorithms for this problem is that formulas for the variance may involve sums of squares, which can lead to numerical instability as well as to arithmetic overflow when dealing with large values.\n\n## Full Content\n\nAlgorithms for calculating variance play a major role in computational statistics. A key difficulty in the design of good algorithms for this problem is that formulas for the variance may involve sums of squares, which can lead to numerical instability as well as to arithmetic overflow when dealing with large values.\n\nNaïve algorithm\nA formula for calculating the variance of an entire population of size N is:\n\n  \n    \n      \n        \n          σ\n          \n            2\n          \n        \n        =\n        \n          \n            \n              (\n              \n                x\n                \n                  2\n                \n              \n              )\n            \n            ¯\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            2\n          \n        \n        =\n        \n          \n            \n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  N\n                \n              \n              \n                x\n                \n                  i\n                \n                \n                  2\n                \n              \n              −\n              (\n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  N\n                \n              \n              \n                x\n                \n                  i\n                \n              \n              \n                )\n                \n                  2\n                \n              \n              \n                /\n              \n              N\n            \n            N\n          \n        \n        .\n      \n    \n    {\\displaystyle \\sigma ^{2}={\\overline {(x^{2})}}-{\\bar {x}}^{2}={\\frac {\\sum _{i=1}^{N}x_{i}^{2}-(\\sum _{i=1}^{N}x_{i})^{2}/N}{N}}.}\n  \n\nUsing Bessel's correction to calculate an unbiased estimate of the population variance from a finite sample of n observations, the formula is:\n\n  \n    \n      \n        \n          s\n          \n            2\n          \n        \n        =\n        \n          (\n          \n            \n              \n                \n                  \n                    ∑\n                    \n                      i\n                      =\n                      1\n                    \n                    \n                      n\n                    \n                  \n                  \n                    x\n                    \n                      i\n                    \n                    \n                      2\n                    \n                  \n                \n                n\n              \n            \n            −\n            \n              \n                (\n                \n                  \n                    \n                      \n                        ∑\n                        \n                          i\n                          =\n                          1\n                        \n                        \n                          n\n                        \n                      \n                      \n                        x\n                        \n                          i\n                        \n                      \n                    \n                    n\n                  \n                \n                )\n              \n              \n                2\n              \n            \n          \n          )\n        \n        ⋅\n        \n          \n            n\n            \n              n\n              −\n              1\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle s^{2}=\\left({\\frac {\\sum _{i=1}^{n}x_{i}^{2}}{n}}-\\left({\\frac {\\sum _{i=1}^{n}x_{i}}{n}}\\right)^{2}\\right)\\cdot {\\frac {n}{n-1}}.}\n  \n\nTherefore, a naïve algorithm to calculate the estimated variance is given by the following:\n\nThis algorithm can easily be adapted to compute the variance of a finite population: simply divide by n instead of n − 1 on the last line.\nBecause SumSq and (Sum×Sum)/n can be very similar numbers, cancellation can lead to the precision of the result to be much less than the inherent precision of the floating-point arithmetic used to perform the computation.  Thus this algorithm should not be used in practice, and several alternate, numerically stable, algorithms have been proposed. This is particularly bad if the standard deviation is small relative to the mean.\n\nComputing shifted data\nThe variance is invariant with respect to changes in a location parameter, a property which can be used to avoid the catastrophic cancellation in this formula.\n\n  \n    \n      \n        Var\n        ⁡\n        (\n        X\n        −\n        K\n        )\n        =\n        Var\n        ⁡\n        (\n        X\n        )\n        .\n      \n    \n    {\\displaystyle \\operatorname {Var} (X-K)=\\operatorname {Var} (X).}\n  \n\nwith \n  \n    \n      \n        K\n      \n    \n    {\\displaystyle K}\n  \n any constant, which leads to the new formula\n\n  \n    \n      \n        \n          σ\n          \n            2\n          \n        \n        =\n        \n          \n            \n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              (\n              \n                x\n                \n                  i\n                \n              \n              −\n              K\n              \n                )\n                \n                  2\n                \n              \n              −\n              (\n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              (\n              \n                x\n                \n                  i\n                \n              \n              −\n              K\n              )\n              \n                )\n                \n                  2\n                \n              \n              \n                /\n              \n              n\n            \n            \n              n\n              −\n              1\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\sigma ^{2}={\\frac {\\sum _{i=1}^{n}(x_{i}-K)^{2}-(\\sum _{i=1}^{n}(x_{i}-K))^{2}/n}{n-1}}.}\n  \n\nthe closer \n  \n    \n      \n        K\n      \n    \n    {\\displaystyle K}\n  \n is to the mean value the more accurate the result will be, but just choosing a value inside the\nsamples range will guarantee the desired stability. If the values \n  \n    \n      \n        (\n        \n          x\n          \n            i\n          \n        \n        −\n        K\n        )\n      \n    \n    {\\displaystyle (x_{i}-K)}\n  \n are small then there are no problems with the sum of its squares, on the contrary, if they are large it necessarily means that the variance is large as well. In any case the second term in the formula is always smaller than the first one therefore no cancellation may occur.\nIf just the first sample is taken as \n  \n    \n      \n        K\n      \n    \n    {\\displaystyle K}\n  \n the algorithm can be written in Python programming language as\n\nThis formula also facilitates the incremental computation that can be expressed as\n\nTwo-pass algorithm\nAn alternative approach, using a different formula for the variance, first computes the sample mean,\n\n  \n    \n      \n        \n          \n            \n              x\n              ¯\n            \n          \n        \n        =\n        \n          \n            \n              \n                ∑\n                \n                  j\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              \n                x\n                \n                  j\n                \n              \n            \n            n\n          \n        \n        ,\n      \n    \n    {\\displaystyle {\\bar {x}}={\\frac {\\sum _{j=1}^{n}x_{j}}{n}},}\n  \n\nand then computes the sum of the squares of the differences from the mean,\n\n  \n    \n      \n        \n          sample variance\n        \n        =\n        \n          s\n          \n            2\n          \n        \n        =\n        \n          \n            \n              \n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                −\n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  )\n                  \n                    2\n                  \n                \n              \n              \n                n\n                −\n                1\n              \n            \n          \n        \n        ,\n      \n    \n    {\\displaystyle {\\text{sample variance}}=s^{2}={\\dfrac {\\sum _{i=1}^{n}(x_{i}-{\\bar {x}})^{2}}{n-1}},}\n  \n\nwhere s is the standard deviation.  This is given by the following code:\n\nThis algorithm is numerically stable if n is small. However, the results of both of these simple algorithms (\"naïve\" and \"two-pass\") can depend inordinately on the ordering of the data and can give poor results for very large data sets due to repeated roundoff error in the accumulation of the sums. Techniques such as compensated summation can be used to combat this error to a degree.\n\nWelford's online algorithm\nIt is often useful to be able to compute the variance in a single pass, inspecting each value \n  \n    \n      \n        \n          x\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle x_{i}}\n  \n only once; for example, when the data is being collected without enough storage to keep all the values, or when costs of memory access dominate those of computation.  For such an online algorithm, a recurrence relation is required between quantities from which the required statistics can be calculated in a numerically stable fashion.\nThe following formulas can be used to update the mean and (estimated) variance of the sequence, for an additional element xn. Here, \n  \n    \n      \n        \n          \n            \n              x\n              ¯\n            \n          \n          \n            n\n          \n        \n        =\n        \n          \n            1\n            n\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          x\n          \n            i\n          \n        \n      \n    \n    {\\textstyle {\\overline {x}}_{n}={\\frac {1}{n}}\\sum _{i=1}^{n}x_{i}}\n  \n denotes the sample mean of the first n samples \n  \n    \n      \n        (\n        \n          x\n          \n            1\n          \n        \n        ,\n        …\n        ,\n        \n          x\n          \n            n\n          \n        \n        )\n      \n    \n    {\\displaystyle (x_{1},\\dots ,x_{n})}\n  \n, \n  \n    \n      \n        \n          σ\n          \n            n\n          \n          \n            2\n          \n        \n        =\n        \n          \n            1\n            n\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          \n            (\n            \n              \n                x\n                \n                  i\n                \n              \n              −\n              \n                \n                  \n                    x\n                    ¯\n                  \n                \n                \n                  n\n                \n              \n            \n            )\n          \n          \n            2\n          \n        \n      \n    \n    {\\textstyle \\sigma _{n}^{2}={\\frac {1}{n}}\\sum _{i=1}^{n}\\left(x_{i}-{\\overline {x}}_{n}\\right)^{2}}\n  \n their biased sample variance, and \n  \n    \n      \n        \n          s\n          \n            n\n          \n          \n            2\n          \n        \n        =\n        \n          \n            1\n            \n              n\n              −\n              1\n            \n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          \n            (\n            \n              \n                x\n                \n                  i\n                \n              \n              −\n              \n                \n                  \n                    x\n                    ¯\n                  \n                \n                \n                  n\n                \n              \n            \n            )\n          \n          \n            2\n          \n        \n      \n    \n    {\\textstyle s_{n}^{2}={\\frac {1}{n-1}}\\sum _{i=1}^{n}\\left(x_{i}-{\\overline {x}}_{n}\\right)^{2}}\n  \n their unbiased sample variance.\n\n  \n    \n      \n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n          \n        \n        =\n        \n          \n            \n              (\n              n\n              −\n              1\n              )\n              \n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n              +\n              \n                x\n                \n                  n\n                \n              \n            \n            n\n          \n        \n        =\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n            −\n            1\n          \n        \n        +\n        \n          \n            \n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n            \n            n\n          \n        \n      \n    \n    {\\displaystyle {\\bar {x}}_{n}={\\frac {(n-1)\\,{\\bar {x}}_{n-1}+x_{n}}{n}}={\\bar {x}}_{n-1}+{\\frac {x_{n}-{\\bar {x}}_{n-1}}{n}}}\n  \n\n  \n    \n      \n        \n          σ\n          \n            n\n          \n          \n            2\n          \n        \n        =\n        \n          \n            \n              (\n              n\n              −\n              1\n              )\n              \n              \n                σ\n                \n                  n\n                  −\n                  1\n                \n                \n                  2\n                \n              \n              +\n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n              )\n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                \n              \n              )\n            \n            n\n          \n        \n        =\n        \n          σ\n          \n            n\n            −\n            1\n          \n          \n            2\n          \n        \n        +\n        \n          \n            \n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n              )\n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                \n              \n              )\n              −\n              \n                σ\n                \n                  n\n                  −\n                  1\n                \n                \n                  2\n                \n              \n            \n            n\n          \n        \n        .\n      \n    \n    {\\displaystyle \\sigma _{n}^{2}={\\frac {(n-1)\\,\\sigma _{n-1}^{2}+(x_{n}-{\\bar {x}}_{n-1})(x_{n}-{\\bar {x}}_{n})}{n}}=\\sigma _{n-1}^{2}+{\\frac {(x_{n}-{\\bar {x}}_{n-1})(x_{n}-{\\bar {x}}_{n})-\\sigma _{n-1}^{2}}{n}}.}\n  \n\n  \n    \n      \n        \n          s\n          \n            n\n          \n          \n            2\n          \n        \n        =\n        \n          \n            \n              n\n              −\n              2\n            \n            \n              n\n              −\n              1\n            \n          \n        \n        \n        \n          s\n          \n            n\n            −\n            1\n          \n          \n            2\n          \n        \n        +\n        \n          \n            \n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n              \n                )\n                \n                  2\n                \n              \n            \n            n\n          \n        \n        =\n        \n          s\n          \n            n\n            −\n            1\n          \n          \n            2\n          \n        \n        +\n        \n          \n            \n              (\n              \n                x\n                \n                  n\n                \n              \n              −\n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  n\n                  −\n                  1\n                \n              \n              \n                )\n                \n                  2\n                \n              \n            \n            n\n          \n        \n        −\n        \n          \n            \n              s\n              \n                n\n                −\n                1\n              \n              \n                2\n              \n            \n            \n              n\n              −\n              1\n            \n          \n        \n        ,\n        \n        n\n        >\n        1\n      \n    \n    {\\displaystyle s_{n}^{2}={\\frac {n-2}{n-1}}\\,s_{n-1}^{2}+{\\frac {(x_{n}-{\\bar {x}}_{n-1})^{2}}{n}}=s_{n-1}^{2}+{\\frac {(x_{n}-{\\bar {x}}_{n-1})^{2}}{n}}-{\\frac {s_{n-1}^{2}}{n-1}},\\quad n>1}\n  \n\nThese formulas suffer from numerical instability , as they repeatedly subtract a small number from a big number which scales with n. A better quantity for updating is the sum of squares of differences from the current mean, \n  \n    \n      \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        (\n        \n          x\n          \n            i\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n          \n        \n        \n          )\n          \n            2\n          \n        \n      \n    \n    {\\textstyle \\sum _{i=1}^{n}(x_{i}-{\\bar {x}}_{n})^{2}}\n  \n, here denoted \n  \n    \n      \n        \n          M\n          \n            2\n            ,\n            n\n          \n        \n      \n    \n    {\\displaystyle M_{2,n}}\n  \n:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  M\n                  \n                    2\n                    ,\n                    n\n                  \n                \n              \n              \n                \n                =\n                \n                  M\n                  \n                    2\n                    ,\n                    n\n                    −\n                    1\n                  \n                \n                +\n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    −\n                    1\n                  \n                \n                )\n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n                )\n              \n            \n            \n              \n                \n                  σ\n                  \n                    n\n                  \n                  \n                    2\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      M\n                      \n                        2\n                        ,\n                        n\n                      \n                    \n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  s\n                  \n                    n\n                  \n                  \n                    2\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      M\n                      \n                        2\n                        ,\n                        n\n                      \n                    \n                    \n                      n\n                      −\n                      1\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}M_{2,n}&=M_{2,n-1}+(x_{n}-{\\bar {x}}_{n-1})(x_{n}-{\\bar {x}}_{n})\\\\[4pt]\\sigma _{n}^{2}&={\\frac {M_{2,n}}{n}}\\\\[4pt]s_{n}^{2}&={\\frac {M_{2,n}}{n-1}}\\end{aligned}}}\n  \n\nThis algorithm was found by Welford, and it has been thoroughly analyzed. It is also common to denote \n  \n    \n      \n        \n          M\n          \n            k\n          \n        \n        =\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            k\n          \n        \n      \n    \n    {\\displaystyle M_{k}={\\bar {x}}_{k}}\n  \n and \n  \n    \n      \n        \n          S\n          \n            k\n          \n        \n        =\n        \n          M\n          \n            2\n            ,\n            k\n          \n        \n      \n    \n    {\\displaystyle S_{k}=M_{2,k}}\n  \n.\nAn example Python implementation for Welford's algorithm is given below.\n\nThis algorithm is much less prone to loss of precision due to catastrophic cancellation, but might not be as efficient because of the division operation inside the loop.  For a particularly robust two-pass algorithm for computing the variance, one can first compute and subtract an estimate of the mean, and then use this algorithm on the residuals.\nThe parallel algorithm below illustrates how to merge multiple sets of statistics calculated online.\n\nWeighted incremental algorithm\nThe algorithm can be extended to handle unequal sample weights, replacing the simple counter n with the sum of weights seen so far.  West (1979) suggests this incremental algorithm:\n\nParallel algorithm\nChan et al. note that Welford's online algorithm detailed above is a special case of an algorithm that works for combining arbitrary sets \n  \n    \n      \n        A\n      \n    \n    {\\displaystyle A}\n  \n and \n  \n    \n      \n        B\n      \n    \n    {\\displaystyle B}\n  \n:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  n\n                  \n                    A\n                    B\n                  \n                \n              \n              \n                \n                =\n                \n                  n\n                  \n                    A\n                  \n                \n                +\n                \n                  n\n                  \n                    B\n                  \n                \n              \n            \n            \n              \n                δ\n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    B\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    A\n                  \n                \n              \n            \n            \n              \n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    A\n                    B\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    A\n                  \n                \n                +\n                δ\n                ⋅\n                \n                  \n                    \n                      n\n                      \n                        B\n                      \n                    \n                    \n                      n\n                      \n                        A\n                        B\n                      \n                    \n                  \n                \n              \n            \n            \n              \n                \n                  M\n                  \n                    2\n                    ,\n                    A\n                    B\n                  \n                \n              \n              \n                \n                =\n                \n                  M\n                  \n                    2\n                    ,\n                    A\n                  \n                \n                +\n                \n                  M\n                  \n                    2\n                    ,\n                    B\n                  \n                \n                +\n                \n                  δ\n                  \n                    2\n                  \n                \n                ⋅\n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                      \n                      \n                        n\n                        \n                          B\n                        \n                      \n                    \n                    \n                      n\n                      \n                        A\n                        B\n                      \n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}n_{AB}&=n_{A}+n_{B}\\\\\\delta &={\\bar {x}}_{B}-{\\bar {x}}_{A}\\\\{\\bar {x}}_{AB}&={\\bar {x}}_{A}+\\delta \\cdot {\\frac {n_{B}}{n_{AB}}}\\\\M_{2,AB}&=M_{2,A}+M_{2,B}+\\delta ^{2}\\cdot {\\frac {n_{A}n_{B}}{n_{AB}}}\\\\\\end{aligned}}}\n  \n.\nThis may be useful when, for example, multiple processing units may be assigned to discrete parts of the input.\nChan's method for estimating the mean is numerically unstable when \n  \n    \n      \n        \n          n\n          \n            A\n          \n        \n        ≈\n        \n          n\n          \n            B\n          \n        \n      \n    \n    {\\displaystyle n_{A}\\approx n_{B}}\n  \n and both are large, because the numerical error in \n  \n    \n      \n        δ\n        =\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            B\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            A\n          \n        \n      \n    \n    {\\displaystyle \\delta ={\\bar {x}}_{B}-{\\bar {x}}_{A}}\n  \n is not scaled down in the way that it is in the \n  \n    \n      \n        \n          n\n          \n            B\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle n_{B}=1}\n  \n case. In such cases, prefer \n  \n    \n      \n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            A\n            B\n          \n        \n        =\n        \n          \n            \n              \n                n\n                \n                  A\n                \n              \n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  A\n                \n              \n              +\n              \n                n\n                \n                  B\n                \n              \n              \n                \n                  \n                    \n                      x\n                      ¯\n                    \n                  \n                \n                \n                  B\n                \n              \n            \n            \n              n\n              \n                A\n                B\n              \n            \n          \n        \n      \n    \n    {\\textstyle {\\bar {x}}_{AB}={\\frac {n_{A}{\\bar {x}}_{A}+n_{B}{\\bar {x}}_{B}}{n_{AB}}}}\n  \n.\n\nThis can be generalized to allow parallelization with AVX, with GPUs, and computer clusters, and to covariance.\n\nExample\nAssume that all floating point operations use standard IEEE 754 double-precision arithmetic. Consider the sample (4, 7, 13, 16) from an infinite population. Based on this sample, the estimated population mean is 10, and the unbiased estimate of population variance is 30.  Both the naïve algorithm and two-pass algorithm compute these values correctly.\nNext consider the sample (108 + 4, 108 + 7, 108 + 13, 108 + 16), which gives rise to the same estimated variance as the first sample.  The two-pass algorithm computes this variance estimate correctly, but the naïve algorithm returns 29.333333333333332 instead of 30.\nWhile this loss of precision may be tolerable and viewed as a minor flaw of the naïve algorithm, further increasing the offset makes the error catastrophic.  Consider the sample (109 + 4, 109 + 7, 109 + 13, 109 + 16).  Again the estimated population variance of 30 is computed correctly by the two-pass algorithm, but the naïve algorithm now computes it as −170.66666666666666.  This is a serious problem with naïve algorithm and is due to catastrophic cancellation in the subtraction of two similar numbers at the final stage of the algorithm.\n\nHigher-order statistics\nTerriberry extends Chan's formulae to calculating the third and fourth central moments, needed for example when estimating skewness and kurtosis:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  M\n                  \n                    3\n                    ,\n                    X\n                  \n                \n                =\n                \n                  M\n                  \n                    3\n                    ,\n                    A\n                  \n                \n                +\n                \n                  M\n                  \n                    3\n                    ,\n                    B\n                  \n                \n              \n              \n                \n                \n\n                \n                +\n                \n                  δ\n                  \n                    3\n                  \n                \n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                      \n                      \n                        n\n                        \n                          B\n                        \n                      \n                      (\n                      \n                        n\n                        \n                          A\n                        \n                      \n                      −\n                      \n                        n\n                        \n                          B\n                        \n                      \n                      )\n                    \n                    \n                      n\n                      \n                        X\n                      \n                      \n                        2\n                      \n                    \n                  \n                \n                +\n                3\n                δ\n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                      \n                      \n                        M\n                        \n                          2\n                          ,\n                          B\n                        \n                      \n                      −\n                      \n                        n\n                        \n                          B\n                        \n                      \n                      \n                        M\n                        \n                          2\n                          ,\n                          A\n                        \n                      \n                    \n                    \n                      n\n                      \n                        X\n                      \n                    \n                  \n                \n              \n            \n            \n              \n                \n                  M\n                  \n                    4\n                    ,\n                    X\n                  \n                \n                =\n                \n                  M\n                  \n                    4\n                    ,\n                    A\n                  \n                \n                +\n                \n                  M\n                  \n                    4\n                    ,\n                    B\n                  \n                \n              \n              \n                \n                \n\n                \n                +\n                \n                  δ\n                  \n                    4\n                  \n                \n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                      \n                      \n                        n\n                        \n                          B\n                        \n                      \n                      \n                        (\n                        \n                          \n                            n\n                            \n                              A\n                            \n                            \n                              2\n                            \n                          \n                          −\n                          \n                            n\n                            \n                              A\n                            \n                          \n                          \n                            n\n                            \n                              B\n                            \n                          \n                          +\n                          \n                            n\n                            \n                              B\n                            \n                            \n                              2\n                            \n                          \n                        \n                        )\n                      \n                    \n                    \n                      n\n                      \n                        X\n                      \n                      \n                        3\n                      \n                    \n                  \n                \n              \n            \n            \n              \n              \n                \n                \n\n                \n                +\n                6\n                \n                  δ\n                  \n                    2\n                  \n                \n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                        \n                          2\n                        \n                      \n                      \n                        M\n                        \n                          2\n                          ,\n                          B\n                        \n                      \n                      +\n                      \n                        n\n                        \n                          B\n                        \n                        \n                          2\n                        \n                      \n                      \n                        M\n                        \n                          2\n                          ,\n                          A\n                        \n                      \n                    \n                    \n                      n\n                      \n                        X\n                      \n                      \n                        2\n                      \n                    \n                  \n                \n                +\n                4\n                δ\n                \n                  \n                    \n                      \n                        n\n                        \n                          A\n                        \n                      \n                      \n                        M\n                        \n                          3\n                          ,\n                          B\n                        \n                      \n                      −\n                      \n                        n\n                        \n                          B\n                        \n                      \n                      \n                        M\n                        \n                          3\n                          ,\n                          A\n                        \n                      \n                    \n                    \n                      n\n                      \n                        X\n                      \n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}M_{3,X}=M_{3,A}+M_{3,B}&{}+\\delta ^{3}{\\frac {n_{A}n_{B}(n_{A}-n_{B})}{n_{X}^{2}}}+3\\delta {\\frac {n_{A}M_{2,B}-n_{B}M_{2,A}}{n_{X}}}\\\\[6pt]M_{4,X}=M_{4,A}+M_{4,B}&{}+\\delta ^{4}{\\frac {n_{A}n_{B}\\left(n_{A}^{2}-n_{A}n_{B}+n_{B}^{2}\\right)}{n_{X}^{3}}}\\\\[6pt]&{}+6\\delta ^{2}{\\frac {n_{A}^{2}M_{2,B}+n_{B}^{2}M_{2,A}}{n_{X}^{2}}}+4\\delta {\\frac {n_{A}M_{3,B}-n_{B}M_{3,A}}{n_{X}}}\\end{aligned}}}\n  \n\nHere the \n  \n    \n      \n        \n          M\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle M_{k}}\n  \n are again the sums of powers of differences from the mean \n  \n    \n      \n        ∑\n        (\n        x\n        −\n        \n          \n            x\n            ¯\n          \n        \n        \n          )\n          \n            k\n          \n        \n      \n    \n    {\\textstyle \\sum (x-{\\overline {x}})^{k}}\n  \n, giving\n\n  \n    \n      \n        \n          \n            \n              \n              \n                \n                  skewness\n                \n                =\n                \n                  g\n                  \n                    1\n                  \n                \n                =\n                \n                  \n                    \n                      \n                        \n                          n\n                        \n                      \n                      \n                        M\n                        \n                          3\n                        \n                      \n                    \n                    \n                      M\n                      \n                        2\n                      \n                      \n                        3\n                        \n                          /\n                        \n                        2\n                      \n                    \n                  \n                \n                ,\n              \n            \n            \n              \n              \n                \n                  kurtosis\n                \n                =\n                \n                  g\n                  \n                    2\n                  \n                \n                =\n                \n                  \n                    \n                      n\n                      \n                        M\n                        \n                          4\n                        \n                      \n                    \n                    \n                      M\n                      \n                        2\n                      \n                      \n                        2\n                      \n                    \n                  \n                \n                −\n                3.\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}&{\\text{skewness}}=g_{1}={\\frac {{\\sqrt {n}}M_{3}}{M_{2}^{3/2}}},\\\\[4pt]&{\\text{kurtosis}}=g_{2}={\\frac {nM_{4}}{M_{2}^{2}}}-3.\\end{aligned}}}\n  \n\nFor the incremental case (i.e., \n  \n    \n      \n        B\n        =\n        {\n        x\n        }\n      \n    \n    {\\displaystyle B=\\{x\\}}\n  \n), this simplifies to:\n\n  \n    \n      \n        \n          \n            \n              \n                δ\n              \n              \n                \n                =\n                x\n                −\n                m\n              \n            \n            \n              \n                \n                  m\n                  ′\n                \n              \n              \n                \n                =\n                m\n                +\n                \n                  \n                    δ\n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  M\n                  \n                    2\n                  \n                  ′\n                \n              \n              \n                \n                =\n                \n                  M\n                  \n                    2\n                  \n                \n                +\n                \n                  δ\n                  \n                    2\n                  \n                \n                \n                  \n                    \n                      n\n                      −\n                      1\n                    \n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  M\n                  \n                    3\n                  \n                  ′\n                \n              \n              \n                \n                =\n                \n                  M\n                  \n                    3\n                  \n                \n                +\n                \n                  δ\n                  \n                    3\n                  \n                \n                \n                  \n                    \n                      (\n                      n\n                      −\n                      1\n                      )\n                      (\n                      n\n                      −\n                      2\n                      )\n                    \n                    \n                      n\n                      \n                        2\n                      \n                    \n                  \n                \n                −\n                \n                  \n                    \n                      3\n                      δ\n                      \n                        M\n                        \n                          2\n                        \n                      \n                    \n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  M\n                  \n                    4\n                  \n                  ′\n                \n              \n              \n                \n                =\n                \n                  M\n                  \n                    4\n                  \n                \n                +\n                \n                  \n                    \n                      \n                        δ\n                        \n                          4\n                        \n                      \n                      (\n                      n\n                      −\n                      1\n                      )\n                      (\n                      \n                        n\n                        \n                          2\n                        \n                      \n                      −\n                      3\n                      n\n                      +\n                      3\n                      )\n                    \n                    \n                      n\n                      \n                        3\n                      \n                    \n                  \n                \n                +\n                \n                  \n                    \n                      6\n                      \n                        δ\n                        \n                          2\n                        \n                      \n                      \n                        M\n                        \n                          2\n                        \n                      \n                    \n                    \n                      n\n                      \n                        2\n                      \n                    \n                  \n                \n                −\n                \n                  \n                    \n                      4\n                      δ\n                      \n                        M\n                        \n                          3\n                        \n                      \n                    \n                    n\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\delta &=x-m\\\\[5pt]m'&=m+{\\frac {\\delta }{n}}\\\\[5pt]M_{2}'&=M_{2}+\\delta ^{2}{\\frac {n-1}{n}}\\\\[5pt]M_{3}'&=M_{3}+\\delta ^{3}{\\frac {(n-1)(n-2)}{n^{2}}}-{\\frac {3\\delta M_{2}}{n}}\\\\[5pt]M_{4}'&=M_{4}+{\\frac {\\delta ^{4}(n-1)(n^{2}-3n+3)}{n^{3}}}+{\\frac {6\\delta ^{2}M_{2}}{n^{2}}}-{\\frac {4\\delta M_{3}}{n}}\\end{aligned}}}\n  \n\nBy preserving the value \n  \n    \n      \n        δ\n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle \\delta /n}\n  \n, only one division operation is needed and the higher-order statistics can thus be calculated for little incremental cost.\nAn example of the online algorithm for kurtosis implemented as described is:\n\nPébaÿ\nfurther extends these results to arbitrary-order central moments, for the incremental and the pairwise cases, and subsequently Pébaÿ et al.\nfor weighted and compound moments. One can also find there similar formulas for covariance.\nChoi and Sweetman\noffer two alternative methods to compute the skewness and kurtosis, each of which can save substantial computer memory requirements and CPU time in certain applications. The first approach is to compute the statistical moments by separating the data into bins and then computing the moments from the geometry of the resulting histogram, which effectively becomes a one-pass algorithm for higher moments. One benefit is that the statistical moment calculations can be carried out to arbitrary accuracy such that the computations can be tuned to the precision of, e.g., the data storage format or the original measurement hardware.  A relative histogram of a random variable can be constructed in the conventional way: the range of potential values is divided into bins and the number of occurrences within each bin are counted and plotted such that the area of each rectangle equals the portion of the sample values within that bin:\n\n  \n    \n      \n        H\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        =\n        \n          \n            \n              h\n              (\n              \n                x\n                \n                  k\n                \n              \n              )\n            \n            A\n          \n        \n      \n    \n    {\\displaystyle H(x_{k})={\\frac {h(x_{k})}{A}}}\n  \n\nwhere \n  \n    \n      \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle h(x_{k})}\n  \n and \n  \n    \n      \n        H\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle H(x_{k})}\n  \n represent the frequency and the relative frequency at bin \n  \n    \n      \n        \n          x\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle x_{k}}\n  \n and \n  \n    \n      \n        A\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        \n        Δ\n        \n          x\n          \n            k\n          \n        \n      \n    \n    {\\textstyle A=\\sum _{k=1}^{K}h(x_{k})\\,\\Delta x_{k}}\n  \n is the total area of the histogram. After this normalization, the \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n raw moments and central moments of \n  \n    \n      \n        x\n        (\n        t\n        )\n      \n    \n    {\\displaystyle x(t)}\n  \n can be calculated from the relative histogram:\n\n  \n    \n      \n        \n          m\n          \n            n\n          \n          \n            (\n            h\n            )\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          x\n          \n            k\n          \n          \n            n\n          \n        \n        H\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        \n        Δ\n        \n          x\n          \n            k\n          \n        \n        =\n        \n          \n            1\n            A\n          \n        \n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          x\n          \n            k\n          \n          \n            n\n          \n        \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        \n        Δ\n        \n          x\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle m_{n}^{(h)}=\\sum _{k=1}^{K}x_{k}^{n}H(x_{k})\\,\\Delta x_{k}={\\frac {1}{A}}\\sum _{k=1}^{K}x_{k}^{n}h(x_{k})\\,\\Delta x_{k}}\n  \n\n  \n    \n      \n        \n          θ\n          \n            n\n          \n          \n            (\n            h\n            )\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          \n            (\n          \n        \n        \n          x\n          \n            k\n          \n        \n        −\n        \n          m\n          \n            1\n          \n          \n            (\n            h\n            )\n          \n        \n        \n          \n            \n              )\n            \n          \n          \n            n\n          \n        \n        \n        H\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        \n        Δ\n        \n          x\n          \n            k\n          \n        \n        =\n        \n          \n            1\n            A\n          \n        \n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          \n            (\n          \n        \n        \n          x\n          \n            k\n          \n        \n        −\n        \n          m\n          \n            1\n          \n          \n            (\n            h\n            )\n          \n        \n        \n          \n            \n              )\n            \n          \n          \n            n\n          \n        \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n        \n        Δ\n        \n          x\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle \\theta _{n}^{(h)}=\\sum _{k=1}^{K}{\\Big (}x_{k}-m_{1}^{(h)}{\\Big )}^{n}\\,H(x_{k})\\,\\Delta x_{k}={\\frac {1}{A}}\\sum _{k=1}^{K}{\\Big (}x_{k}-m_{1}^{(h)}{\\Big )}^{n}h(x_{k})\\,\\Delta x_{k}}\n  \n\nwhere the superscript \n  \n    \n      \n        \n          \n          \n            (\n            h\n            )\n          \n        \n      \n    \n    {\\displaystyle ^{(h)}}\n  \n indicates the moments are calculated from the histogram. For constant bin width \n  \n    \n      \n        Δ\n        \n          x\n          \n            k\n          \n        \n        =\n        Δ\n        x\n      \n    \n    {\\displaystyle \\Delta x_{k}=\\Delta x}\n  \n these two expressions can be simplified using \n  \n    \n      \n        I\n        =\n        A\n        \n          /\n        \n        Δ\n        x\n      \n    \n    {\\displaystyle I=A/\\Delta x}\n  \n:\n\n  \n    \n      \n        \n          m\n          \n            n\n          \n          \n            (\n            h\n            )\n          \n        \n        =\n        \n          \n            1\n            I\n          \n        \n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          x\n          \n            k\n          \n          \n            n\n          \n        \n        \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle m_{n}^{(h)}={\\frac {1}{I}}\\sum _{k=1}^{K}x_{k}^{n}\\,h(x_{k})}\n  \n\n  \n    \n      \n        \n          θ\n          \n            n\n          \n          \n            (\n            h\n            )\n          \n        \n        =\n        \n          \n            1\n            I\n          \n        \n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          \n            (\n          \n        \n        \n          x\n          \n            k\n          \n        \n        −\n        \n          m\n          \n            1\n          \n          \n            (\n            h\n            )\n          \n        \n        \n          \n            \n              )\n            \n          \n          \n            n\n          \n        \n        h\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle \\theta _{n}^{(h)}={\\frac {1}{I}}\\sum _{k=1}^{K}{\\Big (}x_{k}-m_{1}^{(h)}{\\Big )}^{n}h(x_{k})}\n  \n\nThe second approach from Choi and Sweetman is an analytical methodology to combine statistical moments from individual segments of a time-history such that the resulting overall moments are those of the complete time-history. This methodology could be used for parallel computation of statistical moments with subsequent combination of those moments, or for combination of statistical moments computed at sequential times.\nIf \n  \n    \n      \n        Q\n      \n    \n    {\\displaystyle Q}\n  \n sets of statistical moments are known:\n\n  \n    \n      \n        (\n        \n          γ\n          \n            0\n            ,\n            q\n          \n        \n        ,\n        \n          μ\n          \n            q\n          \n        \n        ,\n        \n          σ\n          \n            q\n          \n          \n            2\n          \n        \n        ,\n        \n          α\n          \n            3\n            ,\n            q\n          \n        \n        ,\n        \n          α\n          \n            4\n            ,\n            q\n          \n        \n        )\n        \n      \n    \n    {\\displaystyle (\\gamma _{0,q},\\mu _{q},\\sigma _{q}^{2},\\alpha _{3,q},\\alpha _{4,q})\\quad }\n  \n for \n  \n    \n      \n        q\n        =\n        1\n        ,\n        2\n        ,\n        …\n        ,\n        Q\n      \n    \n    {\\displaystyle q=1,2,\\ldots ,Q}\n  \n, then each \n  \n    \n      \n        \n          γ\n          \n            n\n          \n        \n      \n    \n    {\\displaystyle \\gamma _{n}}\n  \n can\nbe expressed in terms of the equivalent \n  \n    \n      \n        n\n      \n    \n    {\\displaystyle n}\n  \n raw moments:\n\n  \n    \n      \n        \n          γ\n          \n            n\n            ,\n            q\n          \n        \n        =\n        \n          m\n          \n            n\n            ,\n            q\n          \n        \n        \n          γ\n          \n            0\n            ,\n            q\n          \n        \n        \n        \n        \n          \n            for\n          \n        \n        \n        n\n        =\n        1\n        ,\n        2\n        ,\n        3\n        ,\n        4\n        \n        \n           and \n        \n        \n        q\n        =\n        1\n        ,\n        2\n        ,\n        …\n        ,\n        Q\n      \n    \n    {\\displaystyle \\gamma _{n,q}=m_{n,q}\\gamma _{0,q}\\qquad \\quad {\\textrm {for}}\\quad n=1,2,3,4\\quad {\\text{ and }}\\quad q=1,2,\\dots ,Q}\n  \n\nwhere \n  \n    \n      \n        \n          γ\n          \n            0\n            ,\n            q\n          \n        \n      \n    \n    {\\displaystyle \\gamma _{0,q}}\n  \n is generally taken to be the duration of the \n  \n    \n      \n        \n          q\n          \n            t\n            h\n          \n        \n      \n    \n    {\\displaystyle q^{th}}\n  \n time-history, or the number of points if \n  \n    \n      \n        Δ\n        t\n      \n    \n    {\\displaystyle \\Delta t}\n  \n is constant.\nThe benefit of expressing the statistical moments in terms of \n  \n    \n      \n        γ\n      \n    \n    {\\displaystyle \\gamma }\n  \n is that the \n  \n    \n      \n        Q\n      \n    \n    {\\displaystyle Q}\n  \n sets can be combined by addition, and there is no upper limit on the value of \n  \n    \n      \n        Q\n      \n    \n    {\\displaystyle Q}\n  \n.\n\n  \n    \n      \n        \n          γ\n          \n            n\n            ,\n            c\n          \n        \n        =\n        \n          ∑\n          \n            q\n            =\n            1\n          \n          \n            Q\n          \n        \n        \n          γ\n          \n            n\n            ,\n            q\n          \n        \n        \n        \n        \n          for \n        \n        n\n        =\n        0\n        ,\n        1\n        ,\n        2\n        ,\n        3\n        ,\n        4\n      \n    \n    {\\displaystyle \\gamma _{n,c}=\\sum _{q=1}^{Q}\\gamma _{n,q}\\quad \\quad {\\text{for }}n=0,1,2,3,4}\n  \n\nwhere the subscript \n  \n    \n      \n        \n          \n          \n            c\n          \n        \n      \n    \n    {\\displaystyle _{c}}\n  \n represents the concatenated time-history or combined \n  \n    \n      \n        γ\n      \n    \n    {\\displaystyle \\gamma }\n  \n. These combined values of \n  \n    \n      \n        γ\n      \n    \n    {\\displaystyle \\gamma }\n  \n can then be inversely transformed into raw moments representing the complete concatenated time-history\n\n  \n    \n      \n        \n          m\n          \n            n\n            ,\n            c\n          \n        \n        =\n        \n          \n            \n              γ\n              \n                n\n                ,\n                c\n              \n            \n            \n              γ\n              \n                0\n                ,\n                c\n              \n            \n          \n        \n        \n        \n          for \n        \n        n\n        =\n        1\n        ,\n        2\n        ,\n        3\n        ,\n        4\n      \n    \n    {\\displaystyle m_{n,c}={\\frac {\\gamma _{n,c}}{\\gamma _{0,c}}}\\quad {\\text{for }}n=1,2,3,4}\n  \n\nKnown relationships between the raw moments (\n  \n    \n      \n        \n          m\n          \n            n\n          \n        \n      \n    \n    {\\displaystyle m_{n}}\n  \n) and the central moments (\n  \n    \n      \n        \n          θ\n          \n            n\n          \n        \n        =\n        E\n        ⁡\n        [\n        (\n        x\n        −\n        μ\n        \n          )\n          \n            n\n          \n        \n        ]\n        )\n      \n    \n    {\\displaystyle \\theta _{n}=\\operatorname {E} [(x-\\mu )^{n}])}\n  \n)\nare then used to compute the central moments of the concatenated time-history.  Finally, the statistical moments of the concatenated history are computed from the central moments:\n\n  \n    \n      \n        \n          μ\n          \n            c\n          \n        \n        =\n        \n          m\n          \n            1\n            ,\n            c\n          \n        \n        \n        \n          σ\n          \n            c\n          \n          \n            2\n          \n        \n        =\n        \n          θ\n          \n            2\n            ,\n            c\n          \n        \n        \n        \n          α\n          \n            3\n            ,\n            c\n          \n        \n        =\n        \n          \n            \n              θ\n              \n                3\n                ,\n                c\n              \n            \n            \n              σ\n              \n                c\n              \n              \n                3\n              \n            \n          \n        \n        \n        \n          α\n          \n            4\n            ,\n            c\n          \n        \n        =\n        \n          \n            \n              θ\n              \n                4\n                ,\n                c\n              \n            \n            \n              σ\n              \n                c\n              \n              \n                4\n              \n            \n          \n        \n        −\n        3\n      \n    \n    {\\displaystyle \\mu _{c}=m_{1,c}\\qquad \\sigma _{c}^{2}=\\theta _{2,c}\\qquad \\alpha _{3,c}={\\frac {\\theta _{3,c}}{\\sigma _{c}^{3}}}\\qquad \\alpha _{4,c}={\\frac {\\theta _{4,c}}{\\sigma _{c}^{4}}}-3}\n\nCovariance\nVery similar algorithms can be used to compute the covariance.\n\nNaïve algorithm\nThe naïve algorithm is\n\n  \n    \n      \n        Cov\n        ⁡\n        (\n        X\n        ,\n        Y\n        )\n        =\n        \n          \n            \n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              \n                x\n                \n                  i\n                \n              \n              \n                y\n                \n                  i\n                \n              \n              −\n              (\n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              \n                x\n                \n                  i\n                \n              \n              )\n              (\n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              \n                y\n                \n                  i\n                \n              \n              )\n              \n                /\n              \n              n\n            \n            n\n          \n        \n        .\n      \n    \n    {\\displaystyle \\operatorname {Cov} (X,Y)={\\frac {\\sum _{i=1}^{n}x_{i}y_{i}-(\\sum _{i=1}^{n}x_{i})(\\sum _{i=1}^{n}y_{i})/n}{n}}.}\n  \n\nFor the algorithm above, one could use the following Python code:\n\nWith estimate of the mean\nAs for the variance, the covariance of two random variables is also shift-invariant, so given any two constant values \n  \n    \n      \n        \n          k\n          \n            x\n          \n        \n      \n    \n    {\\displaystyle k_{x}}\n  \n and \n  \n    \n      \n        \n          k\n          \n            y\n          \n        \n        ,\n      \n    \n    {\\displaystyle k_{y},}\n  \n it can be written:\n\n  \n    \n      \n        Cov\n        ⁡\n        (\n        X\n        ,\n        Y\n        )\n        =\n        Cov\n        ⁡\n        (\n        X\n        −\n        \n          k\n          \n            x\n          \n        \n        ,\n        Y\n        −\n        \n          k\n          \n            y\n          \n        \n        )\n        =\n        \n          \n            \n              \n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                −\n                \n                  k\n                  \n                    x\n                  \n                \n                )\n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                −\n                \n                  k\n                  \n                    y\n                  \n                \n                )\n                −\n                (\n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                −\n                \n                  k\n                  \n                    x\n                  \n                \n                )\n                )\n                (\n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    n\n                  \n                \n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                −\n                \n                  k\n                  \n                    y\n                  \n                \n                )\n                )\n                \n                  /\n                \n                n\n              \n              n\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\operatorname {Cov} (X,Y)=\\operatorname {Cov} (X-k_{x},Y-k_{y})={\\dfrac {\\sum _{i=1}^{n}(x_{i}-k_{x})(y_{i}-k_{y})-(\\sum _{i=1}^{n}(x_{i}-k_{x}))(\\sum _{i=1}^{n}(y_{i}-k_{y}))/n}{n}}.}\n  \n\nand again choosing a value inside the range of values will stabilize the formula against catastrophic cancellation as well as make it more robust against big sums. Taking the first value of each data set, the algorithm can be written as:\n\nTwo-pass\nThe two-pass algorithm first computes the sample means, and then the covariance:\n\n  \n    \n      \n        \n          \n            \n              x\n              ¯\n            \n          \n        \n        =\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          x\n          \n            i\n          \n        \n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle {\\bar {x}}=\\sum _{i=1}^{n}x_{i}/n}\n  \n\n  \n    \n      \n        \n          \n            \n              y\n              ¯\n            \n          \n        \n        =\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          y\n          \n            i\n          \n        \n        \n          /\n        \n        n\n      \n    \n    {\\displaystyle {\\bar {y}}=\\sum _{i=1}^{n}y_{i}/n}\n  \n\n  \n    \n      \n        Cov\n        ⁡\n        (\n        X\n        ,\n        Y\n        )\n        =\n        \n          \n            \n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  n\n                \n              \n              (\n              \n                x\n                \n                  i\n                \n              \n              −\n              \n                \n                  \n                    x\n                    ¯\n                  \n                \n              \n              )\n              (\n              \n                y\n                \n                  i\n                \n              \n              −\n              \n                \n                  \n                    y\n                    ¯\n                  \n                \n              \n              )\n            \n            n\n          \n        \n        .\n      \n    \n    {\\displaystyle \\operatorname {Cov} (X,Y)={\\frac {\\sum _{i=1}^{n}(x_{i}-{\\bar {x}})(y_{i}-{\\bar {y}})}{n}}.}\n  \n\nThe two-pass algorithm may be written as:\n\nA slightly more accurate compensated version performs the full naive algorithm on the residuals.  The final sums \n  \n    \n      \n        \n          ∑\n          \n            i\n          \n        \n        \n          x\n          \n            i\n          \n        \n      \n    \n    {\\textstyle \\sum _{i}x_{i}}\n  \n and \n  \n    \n      \n        \n          ∑\n          \n            i\n          \n        \n        \n          y\n          \n            i\n          \n        \n      \n    \n    {\\textstyle \\sum _{i}y_{i}}\n  \n should be zero, but the second pass compensates for any small error.\n\nOnline\nA stable one-pass algorithm exists, similar to the online algorithm for computing the variance, that computes co-moment \n  \n    \n      \n        \n          C\n          \n            n\n          \n        \n        =\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            n\n          \n        \n        (\n        \n          x\n          \n            i\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n          \n        \n        )\n        (\n        \n          y\n          \n            i\n          \n        \n        −\n        \n          \n            \n              \n                y\n                ¯\n              \n            \n          \n          \n            n\n          \n        \n        )\n      \n    \n    {\\textstyle C_{n}=\\sum _{i=1}^{n}(x_{i}-{\\bar {x}}_{n})(y_{i}-{\\bar {y}}_{n})}\n  \n:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    −\n                    1\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                  \n                    \n                      \n                        x\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                    \n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    −\n                    1\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                  \n                    \n                      \n                        y\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                    \n                    n\n                  \n                \n              \n            \n            \n              \n                \n                  C\n                  \n                    n\n                  \n                \n              \n              \n                \n                =\n                \n                  C\n                  \n                    n\n                    −\n                    1\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n                )\n                (\n                \n                  y\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    −\n                    1\n                  \n                \n                )\n              \n            \n            \n              \n              \n                \n                =\n                \n                  C\n                  \n                    n\n                    −\n                    1\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                (\n                \n                  x\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    −\n                    1\n                  \n                \n                )\n                (\n                \n                  y\n                  \n                    n\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n                )\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{alignedat}{2}{\\bar {x}}_{n}&={\\bar {x}}_{n-1}&\\,+\\,&{\\frac {x_{n}-{\\bar {x}}_{n-1}}{n}}\\\\[5pt]{\\bar {y}}_{n}&={\\bar {y}}_{n-1}&\\,+\\,&{\\frac {y_{n}-{\\bar {y}}_{n-1}}{n}}\\\\[5pt]C_{n}&=C_{n-1}&\\,+\\,&(x_{n}-{\\bar {x}}_{n})(y_{n}-{\\bar {y}}_{n-1})\\\\[5pt]&=C_{n-1}&\\,+\\,&(x_{n}-{\\bar {x}}_{n-1})(y_{n}-{\\bar {y}}_{n})\\end{alignedat}}}\n  \n\nThe apparent asymmetry in that last equation is due to the fact that \n  \n    \n      \n        (\n        \n          x\n          \n            n\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n          \n        \n        )\n        =\n        \n          \n            \n              n\n              −\n              1\n            \n            n\n          \n        \n        (\n        \n          x\n          \n            n\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n            −\n            1\n          \n        \n        )\n      \n    \n    {\\textstyle (x_{n}-{\\bar {x}}_{n})={\\frac {n-1}{n}}(x_{n}-{\\bar {x}}_{n-1})}\n  \n, so both update terms are equal to \n  \n    \n      \n        \n          \n            \n              n\n              −\n              1\n            \n            n\n          \n        \n        (\n        \n          x\n          \n            n\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            n\n            −\n            1\n          \n        \n        )\n        (\n        \n          y\n          \n            n\n          \n        \n        −\n        \n          \n            \n              \n                y\n                ¯\n              \n            \n          \n          \n            n\n            −\n            1\n          \n        \n        )\n      \n    \n    {\\textstyle {\\frac {n-1}{n}}(x_{n}-{\\bar {x}}_{n-1})(y_{n}-{\\bar {y}}_{n-1})}\n  \n.  Even greater accuracy can be achieved by first computing the means, then using the stable one-pass algorithm on the residuals.\nThus the covariance can be computed as\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  Cov\n                  \n                    N\n                  \n                \n                ⁡\n                (\n                X\n                ,\n                Y\n                )\n                =\n                \n                  \n                    \n                      C\n                      \n                        N\n                      \n                    \n                    N\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        Cov\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      ⁡\n                      (\n                      X\n                      ,\n                      Y\n                      )\n                      ⋅\n                      (\n                      N\n                      −\n                      1\n                      )\n                      +\n                      (\n                      \n                        x\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                      (\n                      \n                        y\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                      )\n                    \n                    N\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        Cov\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      ⁡\n                      (\n                      X\n                      ,\n                      Y\n                      )\n                      ⋅\n                      (\n                      N\n                      −\n                      1\n                      )\n                      +\n                      (\n                      \n                        x\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                      )\n                      (\n                      \n                        y\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                    \n                    N\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        Cov\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      ⁡\n                      (\n                      X\n                      ,\n                      Y\n                      )\n                      ⋅\n                      (\n                      N\n                      −\n                      1\n                      )\n                      +\n                      \n                        \n                          \n                            N\n                            −\n                            1\n                          \n                          N\n                        \n                      \n                      (\n                      \n                        x\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                      )\n                      (\n                      \n                        y\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                          −\n                          1\n                        \n                      \n                      )\n                    \n                    N\n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        Cov\n                        \n                          N\n                          −\n                          1\n                        \n                      \n                      ⁡\n                      (\n                      X\n                      ,\n                      Y\n                      )\n                      ⋅\n                      (\n                      N\n                      −\n                      1\n                      )\n                      +\n                      \n                        \n                          N\n                          \n                            N\n                            −\n                            1\n                          \n                        \n                      \n                      (\n                      \n                        x\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                      (\n                      \n                        y\n                        \n                          n\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                    \n                    N\n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\operatorname {Cov} _{N}(X,Y)={\\frac {C_{N}}{N}}&={\\frac {\\operatorname {Cov} _{N-1}(X,Y)\\cdot (N-1)+(x_{n}-{\\bar {x}}_{n})(y_{n}-{\\bar {y}}_{n-1})}{N}}\\\\&={\\frac {\\operatorname {Cov} _{N-1}(X,Y)\\cdot (N-1)+(x_{n}-{\\bar {x}}_{n-1})(y_{n}-{\\bar {y}}_{n})}{N}}\\\\&={\\frac {\\operatorname {Cov} _{N-1}(X,Y)\\cdot (N-1)+{\\frac {N-1}{N}}(x_{n}-{\\bar {x}}_{n-1})(y_{n}-{\\bar {y}}_{n-1})}{N}}\\\\&={\\frac {\\operatorname {Cov} _{N-1}(X,Y)\\cdot (N-1)+{\\frac {N}{N-1}}(x_{n}-{\\bar {x}}_{n})(y_{n}-{\\bar {y}}_{n})}{N}}.\\end{aligned}}}\n  \n\nA small modification can also be made to compute the weighted covariance:\n\nLikewise, there is a formula for combining the covariances of two sets that can be used to parallelize the computation:\n\n  \n    \n      \n        \n          C\n          \n            X\n          \n        \n        =\n        \n          C\n          \n            A\n          \n        \n        +\n        \n          C\n          \n            B\n          \n        \n        +\n        (\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            A\n          \n        \n        −\n        \n          \n            \n              \n                x\n                ¯\n              \n            \n          \n          \n            B\n          \n        \n        )\n        (\n        \n          \n            \n              \n                y\n                ¯\n              \n            \n          \n          \n            A\n          \n        \n        −\n        \n          \n            \n              \n                y\n                ¯\n              \n            \n          \n          \n            B\n          \n        \n        )\n        ⋅\n        \n          \n            \n              \n                n\n                \n                  A\n                \n              \n              \n                n\n                \n                  B\n                \n              \n            \n            \n              n\n              \n                X\n              \n            \n          \n        \n        .\n      \n    \n    {\\displaystyle C_{X}=C_{A}+C_{B}+({\\bar {x}}_{A}-{\\bar {x}}_{B})({\\bar {y}}_{A}-{\\bar {y}}_{B})\\cdot {\\frac {n_{A}n_{B}}{n_{X}}}.}\n\nWeighted batched version\nA version of the weighted online algorithm that does batched updated also exists: let \n  \n    \n      \n        \n          w\n          \n            1\n          \n        \n        ,\n        …\n        \n          w\n          \n            N\n          \n        \n      \n    \n    {\\displaystyle w_{1},\\dots w_{N}}\n  \n denote the weights, and write\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                  \n                    \n                      \n                        ∑\n                        \n                          i\n                          =\n                          n\n                          +\n                          1\n                        \n                        \n                          n\n                          +\n                          k\n                        \n                      \n                      \n                        w\n                        \n                          i\n                        \n                      \n                      (\n                      \n                        x\n                        \n                          i\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              x\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                    \n                    \n                      \n                        ∑\n                        \n                          i\n                          =\n                          1\n                        \n                        \n                          n\n                          +\n                          k\n                        \n                      \n                      \n                        w\n                        \n                          i\n                        \n                      \n                    \n                  \n                \n              \n            \n            \n              \n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                  \n                    \n                      \n                        ∑\n                        \n                          i\n                          =\n                          n\n                          +\n                          1\n                        \n                        \n                          n\n                          +\n                          k\n                        \n                      \n                      \n                        w\n                        \n                          i\n                        \n                      \n                      (\n                      \n                        y\n                        \n                          i\n                        \n                      \n                      −\n                      \n                        \n                          \n                            \n                              y\n                              ¯\n                            \n                          \n                        \n                        \n                          n\n                        \n                      \n                      )\n                    \n                    \n                      \n                        ∑\n                        \n                          i\n                          =\n                          1\n                        \n                        \n                          n\n                          +\n                          k\n                        \n                      \n                      \n                        w\n                        \n                          i\n                        \n                      \n                    \n                  \n                \n              \n            \n            \n              \n                \n                  C\n                  \n                    n\n                    +\n                    k\n                  \n                \n              \n              \n                \n                =\n                \n                  C\n                  \n                    n\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                \n                  ∑\n                  \n                    i\n                    =\n                    n\n                    +\n                    1\n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n                \n                  w\n                  \n                    i\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n                )\n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n                )\n              \n            \n            \n              \n              \n                \n                =\n                \n                  C\n                  \n                    n\n                  \n                \n              \n              \n                \n                +\n                \n              \n              \n                \n                \n                  ∑\n                  \n                    i\n                    =\n                    n\n                    +\n                    1\n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n                \n                  w\n                  \n                    i\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        x\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                  \n                \n                )\n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                −\n                \n                  \n                    \n                      \n                        y\n                        ¯\n                      \n                    \n                  \n                  \n                    n\n                    +\n                    k\n                  \n                \n                )\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{alignedat}{2}{\\bar {x}}_{n+k}&={\\bar {x}}_{n}&\\,+\\,&{\\frac {\\sum _{i=n+1}^{n+k}w_{i}(x_{i}-{\\bar {x}}_{n})}{\\sum _{i=1}^{n+k}w_{i}}}\\\\{\\bar {y}}_{n+k}&={\\bar {y}}_{n}&\\,+\\,&{\\frac {\\sum _{i=n+1}^{n+k}w_{i}(y_{i}-{\\bar {y}}_{n})}{\\sum _{i=1}^{n+k}w_{i}}}\\\\C_{n+k}&=C_{n}&\\,+\\,&\\sum _{i=n+1}^{n+k}w_{i}(x_{i}-{\\bar {x}}_{n+k})(y_{i}-{\\bar {y}}_{n})\\\\&=C_{n}&\\,+\\,&\\sum _{i=n+1}^{n+k}w_{i}(x_{i}-{\\bar {x}}_{n})(y_{i}-{\\bar {y}}_{n+k})\\\\\\end{alignedat}}}\n  \n\nThe covariance can then be computed as\n\n  \n    \n      \n        \n          Cov\n          \n            N\n          \n        \n        ⁡\n        (\n        X\n        ,\n        Y\n        )\n        =\n        \n          \n            \n              C\n              \n                N\n              \n            \n            \n              \n                ∑\n                \n                  i\n                  =\n                  1\n                \n                \n                  N\n                \n              \n              \n                w\n                \n                  i\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\operatorname {Cov} _{N}(X,Y)={\\frac {C_{N}}{\\sum _{i=1}^{N}w_{i}}}}\n\nSee also\nKahan summation algorithm\nSquared deviations from the mean\nYamartino method\n\nReferences\nExternal links\nWeisstein, Eric W. \"Sample Variance Computation\". MathWorld.\n",
  "categories": [
    "Category:All articles with unsourced statements",
    "Category:Articles with example Python (programming language) code",
    "Category:Articles with example pseudocode",
    "Category:Articles with short description",
    "Category:Articles with unsourced statements from March 2023",
    "Category:Short description matches Wikidata",
    "Category:Statistical algorithms",
    "Category:Statistical deviation and dispersion",
    "Category:Use dmy dates from July 2020"
  ],
  "archived_date": "20241221_183017",
  "source_url": "https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance"
}