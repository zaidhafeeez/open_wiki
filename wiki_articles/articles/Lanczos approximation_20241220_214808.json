{
  "title": "Lanczos approximation",
  "summary": "In mathematics, the Lanczos approximation is a method for computing the gamma function numerically, published by Cornelius Lanczos in 1964. It is a practical alternative to the more popular Stirling's approximation for calculating the gamma function with fixed precision.",
  "content": "---\ntitle: Lanczos approximation\nurl: https://en.wikipedia.org/wiki/Lanczos_approximation\nlanguage: en\ncategories: [\"Category:Articles with example Python (programming language) code\", \"Category:Articles with short description\", \"Category:Gamma and related functions\", \"Category:Numerical analysis\", \"Category:Short description is different from Wikidata\"]\nreferences: 0\nlast_modified: 2024-12-19T13:49:29Z\n---\n\n# Lanczos approximation\n\n## Summary\n\nIn mathematics, the Lanczos approximation is a method for computing the gamma function numerically, published by Cornelius Lanczos in 1964. It is a practical alternative to the more popular Stirling's approximation for calculating the gamma function with fixed precision.\n\n## Full Content\n\nIn mathematics, the Lanczos approximation is a method for computing the gamma function numerically, published by Cornelius Lanczos in 1964. It is a practical alternative to the more popular Stirling's approximation for calculating the gamma function with fixed precision.\n\nIntroduction\nThe Lanczos approximation consists of the formula\n\n  \n    \n      \n        Γ\n        (\n        z\n        +\n        1\n        )\n        =\n        \n          \n            2\n            π\n          \n        \n        \n          \n            \n              (\n              \n                z\n                +\n                g\n                +\n                \n                  \n                    \n                      1\n                      2\n                    \n                  \n                \n              \n              )\n            \n          \n          \n            z\n            +\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          e\n          \n            −\n            (\n            z\n            +\n            g\n            +\n            1\n            \n              /\n            \n            2\n            )\n          \n        \n        \n          A\n          \n            g\n          \n        \n        (\n        z\n        )\n      \n    \n    {\\displaystyle \\Gamma (z+1)={\\sqrt {2\\pi }}{\\left(z+g+{\\tfrac {1}{2}}\\right)}^{z+1/2}e^{-(z+g+1/2)}A_{g}(z)}\n  \n\nfor the gamma function, with\n\n  \n    \n      \n        \n          A\n          \n            g\n          \n        \n        (\n        z\n        )\n        =\n        \n          \n            1\n            2\n          \n        \n        \n          p\n          \n            0\n          \n        \n        (\n        g\n        )\n        +\n        \n          p\n          \n            1\n          \n        \n        (\n        g\n        )\n        \n          \n            z\n            \n              z\n              +\n              1\n            \n          \n        \n        +\n        \n          p\n          \n            2\n          \n        \n        (\n        g\n        )\n        \n          \n            \n              z\n              (\n              z\n              −\n              1\n              )\n            \n            \n              (\n              z\n              +\n              1\n              )\n              (\n              z\n              +\n              2\n              )\n            \n          \n        \n        +\n        ⋯\n        .\n      \n    \n    {\\displaystyle A_{g}(z)={\\frac {1}{2}}p_{0}(g)+p_{1}(g){\\frac {z}{z+1}}+p_{2}(g){\\frac {z(z-1)}{(z+1)(z+2)}}+\\cdots .}\n  \n\nHere g is a real constant that may be chosen arbitrarily subject to the restriction that Re(z+g+⁠1/2⁠) > 0. The coefficients p, which depend on g, are slightly more difficult to calculate (see below). Although the formula as stated here is only valid for arguments in the right complex half-plane, it can be extended to the entire complex plane by the reflection formula,\n\n  \n    \n      \n        Γ\n        (\n        1\n        −\n        z\n        )\n        \n        Γ\n        (\n        z\n        )\n        =\n        \n          \n            π\n            \n              sin\n              ⁡\n              π\n              z\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\Gamma (1-z)\\;\\Gamma (z)={\\pi  \\over \\sin \\pi z}.}\n  \n\nThe series A is convergent, and may be truncated to obtain an approximation with the desired precision. By choosing an appropriate g (typically a small integer), only some 5–10 terms of the series are needed to compute the gamma function with typical single or double floating-point precision. If a fixed g is chosen, the coefficients can be calculated in advance and, thanks to partial fraction decomposition, the sum is recast into the following form:\n\n  \n    \n      \n        \n          A\n          \n            g\n          \n        \n        (\n        z\n        )\n        =\n        \n          c\n          \n            0\n          \n        \n        +\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            N\n          \n        \n        \n          \n            \n              c\n              \n                k\n              \n            \n            \n              z\n              +\n              k\n            \n          \n        \n      \n    \n    {\\displaystyle A_{g}(z)=c_{0}+\\sum _{k=1}^{N}{\\frac {c_{k}}{z+k}}}\n  \n\nThus computing the gamma function becomes a matter of evaluating only a small number of elementary functions and multiplying by stored constants.  The Lanczos approximation was popularized by Numerical Recipes, according to which computing the gamma function becomes \"not much more difficult than other built-in functions that we take for granted, such as sin x or ex.\" The method is also implemented in the GNU Scientific Library, Boost, CPython and musl.\n\nCoefficients\nThe coefficients are given by\n\n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        (\n        g\n        )\n        =\n        \n          \n            \n              2\n              \n            \n            π\n          \n        \n        \n          ∑\n          \n            ℓ\n            =\n            0\n          \n          \n            k\n          \n        \n        \n          C\n          \n            2\n            k\n            +\n            1\n            ,\n            \n            2\n            ℓ\n            +\n            1\n          \n        \n        \n          (\n          \n            ℓ\n            −\n            \n              \n                \n                  1\n                  2\n                \n              \n            \n          \n          )\n        \n        !\n        \n          \n            \n              (\n              \n                ℓ\n                +\n                g\n                +\n                \n                  \n                    \n                      1\n                      2\n                    \n                  \n                \n              \n              )\n            \n          \n          \n            −\n            (\n            ℓ\n            +\n            1\n            \n              /\n            \n            2\n            )\n          \n        \n        \n          e\n          \n            ℓ\n            +\n            g\n            +\n            1\n            \n              /\n            \n            2\n          \n        \n      \n    \n    {\\displaystyle p_{k}(g)={\\frac {\\sqrt {2\\,}}{\\pi }}\\sum _{\\ell =0}^{k}C_{2k+1,\\,2\\ell +1}\\left(\\ell -{\\tfrac {1}{2}}\\right)!{\\left(\\ell +g+{\\tfrac {1}{2}}\\right)}^{-(\\ell +1/2)}e^{\\ell +g+1/2}}\n  \n\nwhere \n  \n    \n      \n        \n          C\n          \n            n\n            ,\n            m\n          \n        \n      \n    \n    {\\displaystyle C_{n,m}}\n  \n represents the (n, m)th element of the matrix of coefficients for the Chebyshev polynomials, which can be calculated recursively from these identities:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  C\n                  \n                    1\n                    ,\n                    \n                    1\n                  \n                \n              \n              \n                \n                =\n                1\n              \n            \n            \n              \n                \n                  C\n                  \n                    2\n                    ,\n                    \n                    2\n                  \n                \n              \n              \n                \n                =\n                1\n              \n            \n            \n              \n                \n                  C\n                  \n                    n\n                    +\n                    1\n                    ,\n                    \n                    1\n                  \n                \n              \n              \n                \n                =\n                −\n                \n                \n                  C\n                  \n                    n\n                    −\n                    1\n                    ,\n                    \n                    1\n                  \n                \n              \n              \n                \n                   for \n                \n                n\n              \n              \n                \n                =\n                2\n                ,\n                3\n                ,\n                4\n                \n                …\n              \n            \n            \n              \n                \n                  C\n                  \n                    n\n                    +\n                    1\n                    ,\n                    \n                    n\n                    +\n                    1\n                  \n                \n              \n              \n                \n                =\n                2\n                \n                \n                  C\n                  \n                    n\n                    ,\n                    \n                    n\n                  \n                \n              \n              \n                \n                   for \n                \n                n\n              \n              \n                \n                =\n                2\n                ,\n                3\n                ,\n                4\n                \n                …\n              \n            \n            \n              \n                \n                  C\n                  \n                    n\n                    +\n                    1\n                    ,\n                    \n                    m\n                    +\n                    1\n                  \n                \n              \n              \n                \n                =\n                2\n                \n                \n                  C\n                  \n                    n\n                    ,\n                    \n                    m\n                  \n                \n                −\n                \n                  C\n                  \n                    n\n                    −\n                    1\n                    ,\n                    \n                    m\n                    +\n                    1\n                  \n                \n              \n              \n                \n                   for \n                \n                n\n              \n              \n                \n                >\n                m\n                =\n                1\n                ,\n                2\n                ,\n                3\n                \n                …\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}C_{1,\\,1}&=1\\\\[5px]C_{2,\\,2}&=1\\\\[5px]C_{n+1,\\,1}&=-\\,C_{n-1,\\,1}&{\\text{ for  }}n&=2,3,4\\,\\dots \\\\[5px]C_{n+1,\\,n+1}&=2\\,C_{n,\\,n}&{\\text{ for  }}n&=2,3,4\\,\\dots \\\\[5px]C_{n+1,\\,m+1}&=2\\,C_{n,\\,m}-C_{n-1,\\,m+1}&{\\text{ for  }}n&>m=1,2,3\\,\\dots \\end{aligned}}}\n  \n\nGodfrey (2001) describes how to obtain the coefficients and also the value of the truncated series A as a matrix product.\n\nDerivation\nLanczos derived the formula from Leonhard Euler's integral\n\n  \n    \n      \n        Γ\n        (\n        z\n        +\n        1\n        )\n        =\n        \n          ∫\n          \n            0\n          \n          \n            ∞\n          \n        \n        \n          t\n          \n            z\n          \n        \n        \n        \n          e\n          \n            −\n            t\n          \n        \n        \n        d\n        t\n        ,\n      \n    \n    {\\displaystyle \\Gamma (z+1)=\\int _{0}^{\\infty }t^{z}\\,e^{-t}\\,dt,}\n  \n\nperforming a sequence of basic manipulations to obtain\n\n  \n    \n      \n        Γ\n        (\n        z\n        +\n        1\n        )\n        =\n        (\n        z\n        +\n        g\n        +\n        1\n        \n          )\n          \n            z\n            +\n            1\n          \n        \n        \n          e\n          \n            −\n            (\n            z\n            +\n            g\n            +\n            1\n            )\n          \n        \n        \n          ∫\n          \n            0\n          \n          \n            e\n          \n        \n        \n          \n            (\n          \n        \n        v\n        (\n        1\n        −\n        log\n        ⁡\n        v\n        )\n        \n          \n            \n              )\n            \n          \n          \n            z\n          \n        \n        \n          v\n          \n            g\n          \n        \n        \n        d\n        v\n        ,\n      \n    \n    {\\displaystyle \\Gamma (z+1)=(z+g+1)^{z+1}e^{-(z+g+1)}\\int _{0}^{e}{\\Big (}v(1-\\log v){\\Big )}^{z}v^{g}\\,dv,}\n  \n\nand deriving a series for the integral.\n\nSimple implementation\nThe following implementation in the Python programming language works for complex arguments and typically gives 13 correct decimal places.\nNote that omitting the smallest coefficients (in pursuit of speed, for example) gives totally inaccurate results; the coefficients must be recomputed from scratch for an expansion with fewer terms.\n\nSee also\nStirling's approximation\nSpouge's approximation\n\nReferences\n\nGodfrey, Paul (2001). \"Lanczos Implementation of the Gamma Function\".\nLanczos, Cornelius (1964). \"A Precision Approximation of the Gamma Function\". Journal of the Society for Industrial and Applied Mathematics, Series B: Numerical Analysis. 1 (1): 86–96. Bibcode:1964SJNA....1...86L. doi:10.1137/0701008. ISSN 0887-459X. JSTOR 2949767.\nPress, W. H.; Teukolsky, S. A.; Vetterling, W. T.; Flannery, B. P. (2007), \"Section 6.1. Gamma Function\", Numerical Recipes: The Art of Scientific Computing (3rd ed.), New York: Cambridge University Press, ISBN 978-0-521-88068-8\nPugh, Glendon (2004). An analysis of the Lanczos Gamma approximation (PDF) (PhD thesis).\nToth, Viktor (2005). \"Programmable Calculators: The Lanczos Approximation\".\nWeisstein, Eric W. \"Lanczos Approximation\". MathWorld.\n",
  "categories": [
    "Category:Articles with example Python (programming language) code",
    "Category:Articles with short description",
    "Category:Gamma and related functions",
    "Category:Numerical analysis",
    "Category:Short description is different from Wikidata"
  ],
  "archived_date": "20241220_214808",
  "source_url": "https://en.wikipedia.org/wiki/Lanczos_approximation"
}