{
  "title": "Commutation matrix",
  "summary": "In mathematics, especially in linear algebra and matrix theory, the commutation matrix is used for transforming the vectorized form of a matrix into the vectorized form of its transpose. Specifically, the commutation matrix K(m,n) is the nm × mn matrix which, for any m × n matrix A, transforms vec(A) into vec(AT):\n\nK(m,n) vec(A) = vec(AT) .\nHere vec(A) is the mn × 1 column vector obtain by stacking the columns of A on top of one another:\n\n  \n    \n      \n        vec\n        ⁡\n        (\n        \n ",
  "content": "---\ntitle: Commutation matrix\nurl: https://en.wikipedia.org/wiki/Commutation_matrix\nlanguage: en\ncategories: [\"Category:Articles with example MATLAB/Octave code\", \"Category:Articles with example Python (programming language) code\", \"Category:Linear algebra\", \"Category:Matrices\"]\nreferences: 0\nlast_modified: 2024-11-18T13:40:26Z\n---\n\n# Commutation matrix\n\n## Summary\n\nIn mathematics, especially in linear algebra and matrix theory, the commutation matrix is used for transforming the vectorized form of a matrix into the vectorized form of its transpose. Specifically, the commutation matrix K(m,n) is the nm × mn matrix which, for any m × n matrix A, transforms vec(A) into vec(AT):\n\nK(m,n) vec(A) = vec(AT) .\nHere vec(A) is the mn × 1 column vector obtain by stacking the columns of A on top of one another:\n\n  \n    \n      \n        vec\n        ⁡\n        (\n        \n \n\n## Full Content\n\nIn mathematics, especially in linear algebra and matrix theory, the commutation matrix is used for transforming the vectorized form of a matrix into the vectorized form of its transpose. Specifically, the commutation matrix K(m,n) is the nm × mn matrix which, for any m × n matrix A, transforms vec(A) into vec(AT):\n\nK(m,n) vec(A) = vec(AT) .\nHere vec(A) is the mn × 1 column vector obtain by stacking the columns of A on top of one another:\n\n  \n    \n      \n        vec\n        ⁡\n        (\n        \n          A\n        \n        )\n        =\n        [\n        \n          \n            A\n          \n          \n            1\n            ,\n            1\n          \n        \n        ,\n        …\n        ,\n        \n          \n            A\n          \n          \n            m\n            ,\n            1\n          \n        \n        ,\n        \n          \n            A\n          \n          \n            1\n            ,\n            2\n          \n        \n        ,\n        …\n        ,\n        \n          \n            A\n          \n          \n            m\n            ,\n            2\n          \n        \n        ,\n        …\n        ,\n        \n          \n            A\n          \n          \n            1\n            ,\n            n\n          \n        \n        ,\n        …\n        ,\n        \n          \n            A\n          \n          \n            m\n            ,\n            n\n          \n        \n        \n          ]\n          \n            \n              T\n            \n          \n        \n      \n    \n    {\\displaystyle \\operatorname {vec} (\\mathbf {A} )=[\\mathbf {A} _{1,1},\\ldots ,\\mathbf {A} _{m,1},\\mathbf {A} _{1,2},\\ldots ,\\mathbf {A} _{m,2},\\ldots ,\\mathbf {A} _{1,n},\\ldots ,\\mathbf {A} _{m,n}]^{\\mathrm {T} }}\n  \n\nwhere A = [Ai,j]. In other words, vec(A) is the vector obtained by vectorizing A in column-major order. Similarly, vec(AT) is the vector obtaining by vectorizing A in row-major order.\nIn the context of quantum information theory, the commutation matrix is sometimes referred to as the swap matrix or swap operator\n\nProperties\nThe commutation matrix is a special type of permutation matrix, and is therefore orthogonal.  In particular, K(m,n) is equal to \n  \n    \n      \n        \n          \n            P\n          \n          \n            π\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {P} _{\\pi }}\n  \n, where \n  \n    \n      \n        π\n      \n    \n    {\\displaystyle \\pi }\n  \n is the permutation over \n  \n    \n      \n        {\n        1\n        ,\n        …\n        ,\n        m\n        n\n        }\n      \n    \n    {\\displaystyle \\{1,\\dots ,mn\\}}\n  \n for which\n\n  \n    \n      \n        π\n        (\n        i\n        +\n        m\n        (\n        j\n        −\n        1\n        )\n        )\n        =\n        j\n        +\n        n\n        (\n        i\n        −\n        1\n        )\n        ,\n        \n        i\n        =\n        1\n        ,\n        …\n        ,\n        m\n        ,\n        \n        j\n        =\n        1\n        ,\n        …\n        ,\n        n\n        .\n      \n    \n    {\\displaystyle \\pi (i+m(j-1))=j+n(i-1),\\quad i=1,\\dots ,m,\\quad j=1,\\dots ,n.}\n  \n\nThe determinant of K(m,n) is \n  \n    \n      \n        (\n        −\n        1\n        \n          )\n          \n            \n              \n                1\n                4\n              \n            \n            n\n            (\n            n\n            −\n            1\n            )\n            m\n            (\n            m\n            −\n            1\n            )\n          \n        \n      \n    \n    {\\displaystyle (-1)^{{\\frac {1}{4}}n(n-1)m(m-1)}}\n  \n.\nReplacing A with AT in the definition of the commutation matrix shows that K(m,n) = (K(n,m))T.  Therefore, in the special case of m = n the commutation matrix is an involution and symmetric.\nThe main use of the commutation matrix, and the source of its name, is to commute the Kronecker product: for every m × n matrix A and every r × q matrix B,\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            (\n            r\n            ,\n            m\n            )\n          \n        \n        (\n        \n          A\n        \n        ⊗\n        \n          B\n        \n        )\n        \n          \n            K\n          \n          \n            (\n            n\n            ,\n            q\n            )\n          \n        \n        =\n        \n          B\n        \n        ⊗\n        \n          A\n        \n        .\n      \n    \n    {\\displaystyle \\mathbf {K} ^{(r,m)}(\\mathbf {A} \\otimes \\mathbf {B} )\\mathbf {K} ^{(n,q)}=\\mathbf {B} \\otimes \\mathbf {A} .}\n  \n\nThis property is often used in developing the higher order statistics of Wishart covariance matrices.\nThe case of n=q=1 for the above equation states that for any column vectors v,w of sizes m,r respectively,\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            (\n            r\n            ,\n            m\n            )\n          \n        \n        (\n        \n          v\n        \n        ⊗\n        \n          w\n        \n        )\n        =\n        \n          w\n        \n        ⊗\n        \n          v\n        \n        .\n      \n    \n    {\\displaystyle \\mathbf {K} ^{(r,m)}(\\mathbf {v} \\otimes \\mathbf {w} )=\\mathbf {w} \\otimes \\mathbf {v} .}\n  \n\nThis property is the reason that this matrix is referred to as the \"swap operator\" in the context of quantum information theory.\nTwo explicit forms for the commutation matrix are as follows: if er,j denotes the j-th canonical vector of dimension r (i.e. the vector with 1 in the j-th coordinate and 0 elsewhere) then\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            (\n            r\n            ,\n            m\n            )\n          \n        \n        =\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            r\n          \n        \n        \n          ∑\n          \n            j\n            =\n            1\n          \n          \n            m\n          \n        \n        \n          (\n          \n            \n              \n                e\n              \n              \n                r\n                ,\n                i\n              \n            \n            \n              \n                \n                  \n                    e\n                  \n                  \n                    m\n                    ,\n                    j\n                  \n                \n              \n              \n                \n                  T\n                \n              \n            \n          \n          )\n        \n        ⊗\n        \n          (\n          \n            \n              \n                e\n              \n              \n                m\n                ,\n                j\n              \n            \n            \n              \n                \n                  \n                    e\n                  \n                  \n                    r\n                    ,\n                    i\n                  \n                \n              \n              \n                \n                  T\n                \n              \n            \n          \n          )\n        \n        =\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            r\n          \n        \n        \n          ∑\n          \n            j\n            =\n            1\n          \n          \n            m\n          \n        \n        \n          (\n          \n            \n              \n                e\n              \n              \n                r\n                ,\n                i\n              \n            \n            ⊗\n            \n              \n                e\n              \n              \n                m\n                ,\n                j\n              \n            \n          \n          )\n        \n        \n          \n            (\n            \n              \n                \n                  e\n                \n                \n                  m\n                  ,\n                  j\n                \n              \n              ⊗\n              \n                \n                  e\n                \n                \n                  r\n                  ,\n                  i\n                \n              \n            \n            )\n          \n          \n            \n              T\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\mathbf {K} ^{(r,m)}=\\sum _{i=1}^{r}\\sum _{j=1}^{m}\\left(\\mathbf {e} _{r,i}{\\mathbf {e} _{m,j}}^{\\mathrm {T} }\\right)\\otimes \\left(\\mathbf {e} _{m,j}{\\mathbf {e} _{r,i}}^{\\mathrm {T} }\\right)=\\sum _{i=1}^{r}\\sum _{j=1}^{m}\\left(\\mathbf {e} _{r,i}\\otimes \\mathbf {e} _{m,j}\\right)\\left(\\mathbf {e} _{m,j}\\otimes \\mathbf {e} _{r,i}\\right)^{\\mathrm {T} }.}\n  \n\nThe commutation matrix may be expressed as the following block matrix:\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            (\n            m\n            ,\n            n\n            )\n          \n        \n        =\n        \n          \n            [\n            \n              \n                \n                  \n                    \n                      K\n                    \n                    \n                      1\n                      ,\n                      1\n                    \n                  \n                \n                \n                  ⋯\n                \n                \n                  \n                    \n                      K\n                    \n                    \n                      1\n                      ,\n                      n\n                    \n                  \n                \n              \n              \n                \n                  ⋮\n                \n                \n                  ⋱\n                \n                \n                  ⋮\n                \n              \n              \n                \n                  \n                    \n                      K\n                    \n                    \n                      m\n                      ,\n                      1\n                    \n                  \n                \n                \n                  ⋯\n                \n                \n                  \n                    \n                      K\n                    \n                    \n                      m\n                      ,\n                      n\n                    \n                  \n                  ,\n                \n              \n            \n            ]\n          \n        \n        ,\n      \n    \n    {\\displaystyle \\mathbf {K} ^{(m,n)}={\\begin{bmatrix}\\mathbf {K} _{1,1}&\\cdots &\\mathbf {K} _{1,n}\\\\\\vdots &\\ddots &\\vdots \\\\\\mathbf {K} _{m,1}&\\cdots &\\mathbf {K} _{m,n},\\end{bmatrix}},}\n  \n\nWhere the p,q entry of n x m block-matrix Ki,j is given by\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            i\n            j\n          \n        \n        (\n        p\n        ,\n        q\n        )\n        =\n        \n          \n            {\n            \n              \n                \n                  1\n                \n                \n                  i\n                  =\n                  q\n                  \n                     and \n                  \n                  j\n                  =\n                  p\n                  ,\n                \n              \n              \n                \n                  0\n                \n                \n                  \n                    otherwise\n                  \n                  .\n                \n              \n            \n            \n          \n        \n      \n    \n    {\\displaystyle \\mathbf {K} _{ij}(p,q)={\\begin{cases}1&i=q{\\text{ and }}j=p,\\\\0&{\\text{otherwise}}.\\end{cases}}}\n  \n\nFor example,\n\n  \n    \n      \n        \n          \n            K\n          \n          \n            (\n            3\n            ,\n            4\n            )\n          \n        \n        =\n        \n          [\n          \n            \n              \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n              \n              \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  0\n                \n                \n                  1\n                \n              \n            \n          \n          ]\n        \n        .\n      \n    \n    {\\displaystyle \\mathbf {K} ^{(3,4)}=\\left[{\\begin{array}{ccc|ccc|ccc|ccc}1&0&0&0&0&0&0&0&0&0&0&0\\\\0&0&0&1&0&0&0&0&0&0&0&0\\\\0&0&0&0&0&0&1&0&0&0&0&0\\\\0&0&0&0&0&0&0&0&0&1&0&0\\\\\\hline 0&1&0&0&0&0&0&0&0&0&0&0\\\\0&0&0&0&1&0&0&0&0&0&0&0\\\\0&0&0&0&0&0&0&1&0&0&0&0\\\\0&0&0&0&0&0&0&0&0&0&1&0\\\\\\hline 0&0&1&0&0&0&0&0&0&0&0&0\\\\0&0&0&0&0&1&0&0&0&0&0&0\\\\0&0&0&0&0&0&0&0&1&0&0&0\\\\0&0&0&0&0&0&0&0&0&0&0&1\\end{array}}\\right].}\n\nCode\nFor both square and rectangular matrices of m rows and n columns, the commutation matrix can be generated by the code below.\n\nPython\nAlternatively, a version without imports:\n\nMATLAB\nR\nExample\nLet \n  \n    \n      \n        A\n      \n    \n    {\\displaystyle A}\n  \n denote the following \n  \n    \n      \n        3\n        ×\n        2\n      \n    \n    {\\displaystyle 3\\times 2}\n  \n matrix:\n\n  \n    \n      \n        A\n        =\n        \n          \n            [\n            \n              \n                \n                  1\n                \n                \n                  4\n                \n              \n              \n                \n                  2\n                \n                \n                  5\n                \n              \n              \n                \n                  3\n                \n                \n                  6\n                \n              \n            \n            ]\n          \n        \n        .\n      \n    \n    {\\displaystyle A={\\begin{bmatrix}1&4\\\\2&5\\\\3&6\\\\\\end{bmatrix}}.}\n  \n\n  \n    \n      \n        A\n      \n    \n    {\\displaystyle A}\n  \n has the following column-major and row-major vectorizations (respectively):\n\n  \n    \n      \n        \n          \n            v\n          \n          \n            col\n          \n        \n        =\n        vec\n        ⁡\n        (\n        A\n        )\n        =\n        \n          \n            [\n            \n              \n                \n                  1\n                \n              \n              \n                \n                  2\n                \n              \n              \n                \n                  3\n                \n              \n              \n                \n                  4\n                \n              \n              \n                \n                  5\n                \n              \n              \n                \n                  6\n                \n              \n            \n            ]\n          \n        \n        ,\n        \n        \n          \n            v\n          \n          \n            row\n          \n        \n        =\n        vec\n        ⁡\n        (\n        \n          A\n          \n            \n              T\n            \n          \n        \n        )\n        =\n        \n          \n            [\n            \n              \n                \n                  1\n                \n              \n              \n                \n                  4\n                \n              \n              \n                \n                  2\n                \n              \n              \n                \n                  5\n                \n              \n              \n                \n                  3\n                \n              \n              \n                \n                  6\n                \n              \n            \n            ]\n          \n        \n        .\n      \n    \n    {\\displaystyle \\mathbf {v} _{\\text{col}}=\\operatorname {vec} (A)={\\begin{bmatrix}1\\\\2\\\\3\\\\4\\\\5\\\\6\\\\\\end{bmatrix}},\\quad \\mathbf {v} _{\\text{row}}=\\operatorname {vec} (A^{\\mathrm {T} })={\\begin{bmatrix}1\\\\4\\\\2\\\\5\\\\3\\\\6\\\\\\end{bmatrix}}.}\n  \n\nThe associated commutation matrix is\n\n  \n    \n      \n        K\n        =\n        \n          \n            K\n          \n          \n            (\n            3\n            ,\n            2\n            )\n          \n        \n        =\n        \n          \n            [\n            \n              \n                \n                  1\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n              \n              \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  1\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n              \n              \n                \n                  ⋅\n                \n                \n                  1\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n              \n              \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  1\n                \n                \n                  ⋅\n                \n              \n              \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  1\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n              \n              \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  ⋅\n                \n                \n                  1\n                \n              \n            \n            ]\n          \n        \n        ,\n      \n    \n    {\\displaystyle K=\\mathbf {K} ^{(3,2)}={\\begin{bmatrix}1&\\cdot &\\cdot &\\cdot &\\cdot &\\cdot \\\\\\cdot &\\cdot &\\cdot &1&\\cdot &\\cdot \\\\\\cdot &1&\\cdot &\\cdot &\\cdot &\\cdot \\\\\\cdot &\\cdot &\\cdot &\\cdot &1&\\cdot \\\\\\cdot &\\cdot &1&\\cdot &\\cdot &\\cdot \\\\\\cdot &\\cdot &\\cdot &\\cdot &\\cdot &1\\\\\\end{bmatrix}},}\n  \n\n(where each \n  \n    \n      \n        ⋅\n      \n    \n    {\\displaystyle \\cdot }\n  \n denotes a zero). As expected, the following holds:\n\n  \n    \n      \n        \n          K\n          \n            \n              T\n            \n          \n        \n        K\n        =\n        K\n        \n          K\n          \n            \n              T\n            \n          \n        \n        =\n        \n          \n            I\n          \n          \n            6\n          \n        \n      \n    \n    {\\displaystyle K^{\\mathrm {T} }K=KK^{\\mathrm {T} }=\\mathbf {I} _{6}}\n  \n\n  \n    \n      \n        K\n        \n          \n            v\n          \n          \n            col\n          \n        \n        =\n        \n          \n            v\n          \n          \n            row\n          \n        \n      \n    \n    {\\displaystyle K\\mathbf {v} _{\\text{col}}=\\mathbf {v} _{\\text{row}}}\n\nReferences\n\nJan R. Magnus and Heinz Neudecker (1988), Matrix Differential Calculus with Applications in Statistics and Econometrics, Wiley.\n",
  "categories": [
    "Category:Articles with example MATLAB/Octave code",
    "Category:Articles with example Python (programming language) code",
    "Category:Linear algebra",
    "Category:Matrices"
  ],
  "archived_date": "20241220_214756",
  "source_url": "https://en.wikipedia.org/wiki/Commutation_matrix"
}